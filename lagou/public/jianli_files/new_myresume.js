var projectTitle=$(".mr_jobe_list .l2 .projectTitle");projectTitle.each(function(){var a=$(this);var b=a.width();a.find("span").css("left",b+5)});var amountScore=parseInt($.trim($(".mr_bfb").text()));var oMoudle={workId:"",eduId:""};var oMoudleScore={expectJobsScore:"",projectExpScore:"",workShowScore:"",skillScore:"",myRemarkScore:""};var oDelMoudle;var oMdScore={expectJobsScore:globals.expectJobsScore,skillScore:globals.skillScore,projectExpScore:globals.projectExperienceScore,workShowScore:globals.workShowScore,myRemarkScore:globals.myRemarkScore};function handleFrames(){try{$.each(Array.prototype.slice.call(window.frames),function(b,c){c.document.body.onclick=function(){c.top.document.body.click()}})}catch(a){}}$(function(){var A=undefined;var an=$("#customTitleName");if(an.val()==""){$("#customBlock .cust_title span").text("自定义标题")}else{$("#customBlock .cust_title span").text(an.val())}if($(".md_flag").length==9){$(".mr_module_add").addClass("dn")}else{$(".mr_module_add").removeClass("dn")}initTitlePosition();var ab=globals.initRatio;updateRatioRM(ab,ab);var aa=$(".mr_myresume_r .scroll_fix").offset();$(window).scroll(function(){var e=$(window).scrollTop();if(aa&&aa.top<=e){$(".mr_myresume_r .scroll_fix").addClass("mr_myresume_r_fix")}else{$(".mr_myresume_r .scroll_fix").removeClass("mr_myresume_r_fix")}});if($(".m_hide").hasClass("dn").length==0){$(".mr_module_add").hide()}var Z="";var I="";var ai=true;window.onbeforeunload=function(){if(ai){return}else{return"内容还未保存，确认离开该页面吗？ "}};z();function z(){var aA=$(".mr_job_des .mr_expjob_content");var az=/&nbsp/g;var e=$.trim(aA.text()).replace(az,"");if(e!=""){$(".mr_job_des").removeClass("dn")}}function K(){$.validator.addMethod("uptextInMce",function e(aE,aD){var az=tinyMCE.get("upjobContent").getContent().replace(/<.*?>/g,"");var aC=getStrLen(az);var aA=0;for(var aB=0;aB<aC;aB++){if(aE.charCodeAt(aB)<27||aE.charCodeAt(aB)>126){aA+=2}else{aA++}}if(aA<=1600||aA==0){return true}else{return false}},"请输入1600字符以内的工作内容");$.validator.classRuleSettings.uptextInMce={uptextInMce:true}}$.validator.addMethod("ueditorLength",function(aB,aA,aC){var e=aB.replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"");var az=getStrLen(e);if(az<=aC[1]&&az>=aC[0]){return true}else{return false}},$.validator.format("请输入长度为 {0} - {1} 的字长"));var k=function(){$(".companyName").autocomplete({source:function(aA,e){var az=new Array();$.ajax({type:"POST",async:false,url:sctx+"/suggestion",dataType:"jsonp",jsonp:"suggestCompanyback",data:{input:aA.term,type:2,num:6}}).done(function(aB){if(aB!=null&&aB!=undefined){for(var aC in aB){var aE=aB[aC];if(aE!=null&&aE!=undefined&&aE.length>0){for(var aD in aE){az.push(aE[aD].cont)}}}}e(az)})},minLength:1})};$(".mr_created").delegate(".companyName","keydown keyup",function(){myresumeCommon.utils.throttle(k,[],this,300)});var G=function(){$(".autoPosition").autocomplete({source:function(aA,e){var az=new Array();$.ajax({type:"POST",async:false,url:sctx+"/suggestion",dataType:"jsonp",jsonp:"suggestPositionback",data:{input:aA.term,type:5,num:6}}).done(function(aB){if(aB!=null&&aB!=undefined){for(var aC in aB){var aE=aB[aC];if(aE!=null&&aE!=undefined&&aE.length>0){for(var aD in aE){az.push(aE[aD].cont)}}}}e(az)})},minLength:1})};$(".mr_created").delegate(".autoPosition","keydown keyup",function(){myresumeCommon.utils.throttle(G,[],this,300)});var y=function(){$(".autoCollege").autocomplete({source:function(aA,e){var az=new Array();$.ajax({type:"POST",async:false,url:sctx+"/suggestion",dataType:"jsonp",jsonp:"suggestCollegeback",data:{input:aA.term,type:3,num:6}}).done(function(aB){if(aB!=null&&aB!=undefined){for(var aC in aB){var aE=aB[aC];if(aE!=null&&aE!=undefined&&aE.length>0){for(var aD in aE){az.push(aE[aD].cont)}}}}e(az)})},minLength:1})};$(".mr_created").delegate(".autoCollege","keydown keyup",function(){myresumeCommon.utils.throttle(y,[],this,300)});var s=function(){$(".autoMajor").autocomplete({source:function(aA,e){var az=new Array();$.ajax({type:"POST",async:false,url:sctx+"/suggestion",dataType:"jsonp",jsonp:"suggestMajorback",data:{input:aA.term,type:4,num:6}}).done(function(aB){if(aB!=null&&aB!=undefined){for(var aC in aB){var aE=aB[aC];if(aE!=null&&aE!=undefined&&aE.length>0){for(var aD in aE){az.push(aE[aD].cont)}}}}e(az)})},minLength:1})};$(".mr_created").delegate(".autoMajor","keydown keyup",function(){myresumeCommon.utils.throttle(s,[],this,300)});$(".mr_name_edit .ed_name,.mr_intro_edit .ed_name").bind("click",function(az){az.stopPropagation();$(".select_color").removeClass("select_color");$(this).addClass("select_color")});$(".mr_r_nav ul li:first").bind("click",function(az){az.stopPropagation();var aA=$(this).find("em");if(!aA.is(":hidden")){aA.addClass("dn")}});if($(".mr_sns")&&$(".mr_sns a").length>0){ay()}function ay(){var e=$(".mr_sns a");e.eq(e.length-1).addClass();e.each(function(aC){var aB=$(this).data("sns");var aE=$(this);var aA=aE.find("span");var aD=aA.find("em");switch(parseInt(aB)){case 1:var az=document.createTextNode("Twitter");aE.addClass("sns1");break;case 2:var az=document.createTextNode("Dribbble");aE.addClass("sns2");break;case 3:var az=document.createTextNode("Behance");aE.addClass("sns3");break;case 4:var az=document.createTextNode("LinkedIn");aE.addClass("sns4");break;case 5:var az=document.createTextNode("Quora");aE.addClass("sns5");break;case 6:var az=document.createTextNode("Github");aE.addClass("sns6");break;case 7:var az=document.createTextNode("知乎");aE.addClass("sns7");break;case 8:var az=document.createTextNode("LOFTER");aE.addClass("sns8");break;case 9:var az=document.createTextNode("UI中国");aE.addClass("sns9");break;case 10:var az=document.createTextNode("新浪微博");aE.addClass("sns10");break;case 11:var az=document.createTextNode("SegmentFault");aE.addClass("sns11");break;case 12:var az=document.createTextNode("StackoverFlow");aE.addClass("sns12");break}aA.prepend($(az)).css("marginLeft",-(aA.width()+20)/2+"px")})}$(".mr_sns").delegate("a","hover",function(){$(this).find("span").toggle()});$(".mr_headfile").hover(function(){$(".shadow").show()},function(){$(".shadow").hide()});$(".mr_p_name,.mr_p_info,.mr_p_introduce").hover(function(){$(this).addClass("mr_active").find(".mr_edit").removeClass("dn")},function(){$(this).removeClass("mr_active").find(".mr_edit").addClass("dn")});$(".mr_p_name .mr_edit").bind("click",function(){$(".mr_p_name").hide();$("#mr_name").val($(".mr_p_name .mr_name").text());$(".mr_name_edit").removeClass("dn");$("#nameForm").find("input#mr_name")[0].focus();ai=false});var i=$("input#mr_name");i.on("keyup",function(){var e=$.trim(i.val()).length;if(e==0){$(this).attr("placeholder","姓名")}});$(".mr_name_edit .cancel").bind("click",function(){$(".mr_p_name").show();$(".mr_name_edit").addClass("dn");ai=true});$(".mr_p_introduce .mr_edit").bind("click",function(){$(".mr_p_introduce").hide();if($(this).attr("data-type")=="0"){$("#mr_intro").val($(".mr_p_introduce .mr_intro").text())}$(".mr_intro_edit").removeClass("dn");$("#mr_intro").focus();$("#introduceForm .mroneError").hide();ai=false});$(".mr_intro_edit .cancel").bind("click",function(){$(".mr_p_introduce").show();$(".mr_intro_edit").addClass("dn");ai=true});$(".a").hover(function(){var aA=$(".birth_span");var az=$.trim(aA.text());var e=$(".a");if(az!=""&&az!="出生"){aA.removeClass("dn");e.css("cursor","pointer")}else{e.css("cursor","default")}},function(){setTimeout(function(){var e=$(".birth_span");e.addClass("dn")},90)});jQuery.validator.addMethod("truename",function(aA,e){var az=/^([a-zA-Z ]+|[\u4e00-\u9fa5]+)$/;return this.optional(e)||az.test(aA)},"请输入有效的公司简称");jQuery.validator.addMethod("truename2",function(aA,e){var az=/([·`~!@#$^&':;,?~！……&；：。，、？=])/;return this.optional(e)||!az.test(aA)},"请输入有效的名字");$("#nameForm").validate({rules:{mr_name:{required:true,truename2:true,rangeLenStr:[1,15]}},messages:{mr_name:{required:"必填",truename2:"格式错误",rangeLenStr:"请输入真实姓名"}},errorPlacement:function(e,az){e.appendTo($(az).parent());$(".c_section span.error").css("margin","5px 0 10px 138px")},submitHandler:function(aB){var aA=globals.token;var az=$('input[name="mr_name"]',aB).val();var e=globals.resumeId;az=$.trim(az);$(aB).find(":submit").val("保存中...").attr("disabled",true);$.ajax({url:ctx+"/resume/updateUserName.json",type:"POST",data:{name:az,id:e,resubmitToken:aA},dataType:"json"}).done(function(aC){if(aC.success){ai=true;globals.token=aC.resubmitToken;$("#nowrap").html(az+"&nbsp;");var aF=aC.content.resume;var aE=aF.name;$(".mr_name_edit").addClass("dn");$(".mr_name").html(aE).parent().show();var aD=aC.content.url;$("#body").append("<iframe id='ifr' style='display:none;' src='"+aD+"'></iframe>")}else{alert(aC.msg)}$(aB).find(":submit").val("保 存").attr("disabled",false)})}});function T(aA){var e=0;for(var az=0;az<aA.length;az++){var aB=aA.charCodeAt(az);if((aB>=1&&aB<=126)||(65376<=aB&&aB<=65439)){e++}else{e+=2}}return e}$("#introduceForm").on("keyup",'input[name="mr_intro"]',function(){var az=$(this);var aA=$.trim(az.val());var e=T(aA);if(e==0){ai=true;az.siblings("span.mroneError").text("必填").css("display","block")}else{if(e<4){ai=true;az.siblings("span.mroneError").text("太短了").css("display","block")}else{if(e>=4&&e<=58){az.siblings("span.mroneError").hide()}else{if(e>58){az.siblings("span.mroneError").text("请输入4-58个字符的介绍").css("display","block")}}}}});$("#introduceForm .save").click(function(){var aC=$(this);var aE=$.trim($("#introduceForm #mr_intro").val());var e=T(aE);if(e==0){ai=true;aC.siblings("span.mroneError").text("必填").css("display","block")}else{if(e<4){ai=true;aC.siblings("span.mroneError").text("太短了").css("display","block")}else{if(e>=4&&e<=58){var aB=$("#introduceForm");var az=globals.resumeId;var aD=$('input[name="mr_intro"]',aB).val();$(aB).find(":submit").val("保存中...").attr("disabled",true);var aA=globals.token;$.ajax({url:ctx+"/resume/oneWord.json",type:"POST",data:{oneWord:aD,resubmitToken:aA,id:az},dataType:"json"}).done(function(aH){if(aH.success){globals.token=aH.resubmitToken;$(".mr_intro_edit").addClass("dn");var aG=$(".mr_intro");if(aG.hasClass("mr_intro_grey")){aG.removeClass("mr_intro_grey").addClass("mr_intro_normal")}aG.text(aD).attr("title",aD).parent().show();var aJ=aH.content.infoCompleteStatus.score;var aF=parseInt($.trim($(".mr_bfb").text()));var aI=amountScore-aF+aJ;updateRatioRM(aJ,aI)}else{alert(aH.msg)}$(aB).find(":submit").val("保 存").attr("disabled",false);ai=true})}else{if(e>58){aC.siblings("span.mroneError").text("请输入4-58个字符的介绍").show()}}}}});$(".mr_created,.mr_uncreate").delegate(".normal_s","click",function(aA){aA.stopPropagation();var aB=$(this).find(".xl_list");var az=aB.is(":hidden");$(".xl_list").hide();$(".select_color").removeClass("select_color");if(az){$(this).addClass("select_color");aB.show()}else{aB.hide()}if(H){H.hide()}if(h){h.hide()}if(au){au.hide()}});$(".mr_created,.mr_uncreate").delegate(".email_s,.mobile_s","focus",function(aA){aA.stopPropagation();var aB=$(this).find(".xl_list");var az=aB.is(":hidden");$(".xl_list").hide();$(".select_color").removeClass("select_color");if(az){$(this).addClass("select_color");aB.show()}else{aB.hide()}if(H){H.hide()}if(h){h.hide()}if(au){au.hide()}});$(".mr_self_state .mr_self_s").bind("click",function(az){az.stopPropagation();$(".form_wrap").removeClass("select_color");var aA=$(this).find(".xl_list");if(aA.is(":hidden")){$(this).addClass("select_color")}aA.toggle()});$(".mr_self_state .mr_self_s").hover(function(){if($(this).hasClass("active")){$(this).removeClass("active")}},function(){var e=$(this).find(".xl_list");if(e.is(":hidden")){$(this).addClass("active")}});$("#mr_mobile,#mr_email").click(function(az){az.stopPropagation();$(".select_color").removeClass("select_color");$(this).parent().addClass("select_color");h.hide()});$(".xl_list").bind("click",function(az){az.stopPropagation()});$(".mr_my_qr").hover(function(){$(this).addClass("open")},function(){$(this).removeClass("open")});$(document).click(function(){var az=$(".mr_years");if(az.find(".xl_list").is(":visible")&&$("#mr_year").val()==""){$("<span class='error'>").text("必选").appendTo(az)}var aB=$(".mr_months");if(aB.find(".xl_list").is(":visible")&&$("#mr_month").val()==""){$("<span class='error'>").text("必选").appendTo(aB)}$(".xl_list").hide();$(".select_color").removeClass("select_color");var e=$(".mr_down_tip");if(!e.is(":hidden")){e.addClass("dn")}if(H){H.hide()}if(h){h.hide()}if(au){au.hide()}if(V){V.hide()}if(R){R.hide()}if(av){av.hide()}if(E){E.hide()}if(U){U.hide()}if(d){d.hide()}if(ad){ad.hide()}if(D){D.hide()}if(V){V.hide()}if(R){R.hide()}var aA=$(".mr_self_state .mr_self_s");if(!aA.hasClass("active")){aA.addClass("active")}var aC=$(".set_default_wrap");if(aC.hasClass("active")){aC.trigger("click")}});$(".ul_xl").delegate("li","click",function(){$("#xl").val($(this).text());$(this).parent().parent().hide();$(".select_color").removeClass("select_color")});$(".ul_gznx").delegate("li","click",function(){var e=$(this).text();$("#gznx").val(e);if($.trim(e)=="应届毕业生"){var az=$(".ul_shenfen li[data-id = '1']");if(az.length!=0){$("#shenfen").val(az.text());globals.personIdFlag="1"}}else{var aA=$(".ul_shenfen li[data-id = '2']");if(aA.length!=0){$("#shenfen").val(aA.text());globals.personIdFlag="2"}}$(this).parent().parent().hide();$(".select_color").removeClass("select_color")});$(".mr_years .normal_s, .mr_months .normal_s").click(function(){$(this).parent().find("span.error").remove()});$(".ul_year").delegate("li","click",function(){$("#mr_year").val($(this).text());$(this).parent().parent().hide();$(".select_color").removeClass("select_color")});$(".ul_month").delegate("li","click",function(){$("#mr_month").val($(this).text());$(this).parent().parent().hide();$(".select_color").removeClass("select_color")});$(".ul_shenfen").delegate("li","click",function(){$("#shenfen").val($(this).text());globals.personIdFlag=$(this).attr("data-id");$(this).parent().parent().hide();$(".select_color").removeClass("select_color")});$(".ul_self_state").delegate("li","click",function(){var az=globals.token;var e=$(this).text();var aA=$(this);$.ajax({url:ctx+"/resume/updateUserStatus.json",type:"post",data:{status:e,resumeId:globals.resumeId,resubmitToken:az},dataType:"json"}).done(function(aB){if(aB.success){globals.resubmitToken=aB.resubmitToken;updateResumeTime(aB.content.refreshTime);$("#self_state").val(e);aA.parent().parent().hide();$(".select_color").removeClass("select_color")}else{alert(aB.msg)}})});$(".mr_sex .mr_man").bind("click",function(){$(this).addClass("active").find("i").addClass("active");$(".mr_sex .mr_women").removeClass("active").find("i").removeClass("active")});$(".mr_sex .mr_women").bind("click",function(){$(this).addClass("active").find("i").addClass("active");$(".mr_sex .mr_man").removeClass("active").find("i").removeClass("active")});$(".sns_area").delegate('input[id^="sns"]',"click",function(az){az.stopPropagation();$(".select_color").removeClass("select_color");$(this).parent().addClass("select_color")});$(".sns_area").delegate(".sns_del","click",function(){var az=$(this).parent().find("i").attr("class");az="."+az;$(this).parent().remove();$(".mr_add_m ul .active").removeClass("active");$(".mr_add_m "+az+"").show();var e=$(".sns_area .mr_sns_m");if(e.length==0){$(".mr_add_sns").hide();$(".sns_empty").show()}return false});$(".mr_add_m li").hover(function(){$(this).find("span").show()},function(){$(this).find("span").hide()});$(".mr_locks").hover(function(){$(this).find("em").show()},function(){$(this).find("em").hide()});$(".mr_add_m ul").delegate("li","click",function(az){az.stopPropagation();if($(this).hasClass("active")){$(this).removeClass("active")}else{$(this).addClass("active")}});$(".mr_add_op .sns_save").bind("click",function(aA){aA.stopPropagation();var az="";$(".mr_add_m ul .active").each(function(aB){var e=$(this).data("flag");var aC="sns"+e;az+='<div class="form_wrap mr_sns_m">';az+=' <i class="'+aC+'"></i>';az+=' <em class=""></em>';az+=' <a href="javascript:;" class="sns_del"></a>';az+=' <input type="text" id="'+aC+'" name="'+aC+'" data-sns="'+e+'" class="mr_button" />';az+="</div>"});$(".mr_add_m ul .active").removeClass("active");$(".sns_area").append(az);$(".mr_add_m").slideUp("dn");return false});$(".mr_add_m").click(function(az){az.stopPropagation()});$(".mr_add_op .sns_cancel").bind("click",function(az){az.stopPropagation();$(".mr_add_m li").removeClass("active");$(".mr_add_m").slideUp("dn");return false});$(".sns_add").bind("click",function(){if($(".sns_area .mr_sns_m").length!=12){$(".mr_add_m li").show();$(".sns_area i").each(function(e){var az=$(this).attr("class");az="."+az;$(".mr_add_m "+az+"").hide()});$(".mr_add_m").slideToggle(300)}});$(".sns_add_empty").bind("click",function(){if($(".sns_area .mr_sns_m").length!=12){$(".mr_add_m li").show();$(".sns_area i").each(function(e){var az=$(this).attr("class");az="."+az;$(".mr_add_m "+az+"").hide()});$(".mr_add_m").slideToggle(300)}});$(".sns_area").delegate("input[id^='sns']","keyup",function(){if($.trim($(this).val())){$(this).parent().find("em").removeClass("mr_no").removeClass("mr_ok").addClass("mr_ok")}});var aw={required:true,checkUrlNot:true,maxlength:100};$("#olinfoForm").validate({rules:{mr_year:{required:true},mr_month:{required:true},mr_mobile:{required:true,isMobile:true,maxlength:11},mr_email:{required:true,email:true,maxlength:100},sns1:aw,sns2:aw,sns3:aw,sns4:aw,sns5:aw,sns6:aw,sns7:aw,sns8:aw,sns9:aw,sns10:aw,sns11:aw,sns12:aw},messages:{mr_year:{required:"必选"},mr_month:{required:"必选"},mr_mobile:{required:"必填",isMobile:"目前仅支持11位有效中国大陆号码",maxlength:"目前仅支持11位有效中国大陆号码"},mr_email:{required:"必填",email:"请输入正确的邮箱",maxlength:"输入100个字符以内的邮箱地址"}},errorPlacement:function(e,az){if($(az).data("sns")){$(az).parent().find("em").addClass("mr_no")}else{e.insertAfter($(az).parent());$(".c_section span.error").css("margin","5px 0 10px 138px")}},submitHandler:function(e){$(e).find(":submit").val("保存中...").attr("disabled",true);$("#sess_submit").one("click",function(){var aL=$('input[name="shenfen"]',e).val();var aE=$('input[name="mr_year"]',e).val();var aK=$('input[name="mr_month"]',e).val();var aF=$('input[name="xl"]',e).val();var aB=$('input[name="gznx"]',e).val();var aA=$('input[name="szcs"]',e).val();var aD=$('input[name="mr_mobile"]',e).val();var aM=$('input[name="mr_email"]',e).val();var aH=$(".sns_area input");var aG=$(".mr_sex span.active em").text();var az={};var aJ=[];var aI="";var aC=globals.token;aH.each(function(aP){var aO=$(this).val();var aN=$(this).data("sns");az[aN]=aO;var aQ={};aQ.accountId=aN;aQ.accountUrl=aO;aJ.push(aQ);var aR="sns"+aN;if($.trim(aO).indexOf("http://")==0||$.trim(aO).indexOf("https://")==0){aO=aO}else{aO="http://"+aO}aI+="<a href='"+aO+"' target='_blank' data-sns='"+aN+"' data-site='"+aO+"' class='"+aR+"'><span><em></em></span></a>"});aJ=JSON.stringify(aJ);$.ajax({url:ctx+"/resume/basic.json",type:"post",data:{highestEducation:aF,workYear:aB,phone:aD,email:aM,liveCity:aA,birthday:aE+"."+aK,workYear:aB,sex:aG,type:1,resubmitToken:aC,socialAccountJson:aJ,userIdentity:globals.personIdFlag},dataType:"json"}).done(function(aZ){globals.token=aZ.resubmitToken;if(aZ.success){$("#sess_submit").hide().siblings("input").show();$(".w_tips").hide();ak();Z="";ai=true;updateResumeTime(aZ.content.refreshTime);var aP=aZ.content.infoCompleteStatus.score;var aR=parseInt($.trim($(".mr_bfb").text()));var aQ=amountScore-aR+aP;updateRatioRM(aP,aQ);$("#olinfoForm .mr_info_edit").addClass("dn");$(".mr_infoed .shenfen em").text(aL).attr("title",aL);aB=$('input[name="gznx"]',e).val();var aN=aB;var aV=aN;if($.trim(aB)!="应届毕业生"){$(".mr_infoed .base_info .job_span").text(aB+="工作经验");aN+="工作经验"}else{$(".mr_infoed .base_info .job_span").text(aB)}$(".mr_infoed .base_info .s").text(aG);if(aZ.content.resume.ageNum){var aO=$(".mr_infoed .base_info .a").show();aO.children(".age").text(aZ.content.resume.ageNum+"岁");aO.children(".birth_span").html(aE+"年"+aK+"月出生<em></em>")}else{$(".mr_infoed .base_info .a").hide()}$(".mr_infoed .base_info .x").text(aF);$(".mr_infoed .base_info .d").text(aA);$(".mr_infoed .mobile em").text(aD).attr("title",aD);$(".mr_infoed .email em").text(aM).attr("title",aM);if(aH.length>0){$(".mr_infoed .mr_sns").removeClass("dn")}else{$(".mr_infoed .mr_sns").addClass("dn")}$(".mr_infoed .mr_sns").html(aI);var aY=$(".mr_module .flag_work");var aW=$("#workExperience");var aX=aZ.content.isOpenMyResume;var aS=aZ.content.firstOpen;if(aB=="应届毕业生"){aW.find(".mr_title_c").text("实习经历");aW.find(".mr_empty_add span").text("添加实习经历");$(".mr_module li[data-md = 'workExperience'] .mr_m_name").text("实习经历");if(!aY.is(":hidden")){aY.addClass("dn")}m(false,aX,aS)}else{aW.find(".mr_title_c").text("工作经历");aW.find(".mr_empty_add span").text("添加工作经历");$(".mr_module li[data-md = 'workExperience'] .mr_m_name").text("工作经历");if($("#workExperience .mr_jobe_list").length==0){var aY=$(".mr_module .flag_work");if(aY.is(":hidden")){aY.removeClass("dn")}}m(true,aX,aS)}var aU=$(".mr_infoed .mr_edit_on");aU.attr("data-sf",$.trim(aL.split("·")[0]));aU.attr("data-shenfen",aL);aU.attr("data-sex",aG);aU.attr("data-xl",aF);aU.attr("data-gzjy",aV);aU.attr("data-city",aA);aU.attr("data-mobile",aD);aU.attr("data-email",aM);aU.attr("data-birthYear",aE);aU.attr("data-birthMonth",aK);$(".mr_p_info").show();var aT=$(".mr_ope .mr_cancel");aT.attr("data-sf",$.trim(aL.split("·")[0]));aT.attr("data-shenfen",aL);aT.attr("data-sex",aG);aT.attr("data-xl",aF);aT.attr("data-gzjy",aV);aT.attr("data-city",aA);aT.attr("data-mobile",aD);aT.attr("data-email",aM);aT.attr("data-birthYear",aE);aT.attr("data-birthMonth",aK);ay()}else{alert(aZ.msg)}$(e).find(":submit").val("保 存").attr("disabled",false)})});if(($("#mr_mobile").val()!=$("#sess_phone").val()&&$("#sess_phone").val().length>0)&&($("#mr_email").val()!=$("#sess_email").val()&&$("#sess_email").val().length>0)){$("#mr_mobile").parent().nextAll("p.w_tips:eq(0)").show();$("#sess_submit").show().siblings("input").hide();return}else{if($("#mr_mobile").val()!=$("#sess_phone").val()&&$("#mr_mobile").val().length>0&&$("#sess_phone").val().length>0){$("#mr_mobile").parent().nextAll("p.w_tips:eq(1)").show();$("#sess_submit").show().siblings("input").hide();return}else{$("#mr_mobile").parent().nextAll("p.w_tips:eq(1)").hide();if($("#mr_email").val()!=$("#sess_email").val()&&$("#mr_email").val().length>0&&$("#sess_email").val().length>0){$("#mr_email").parent().nextAll("p.w_tips:eq(2)").show();$("#sess_submit").show().siblings("input").hide();return}else{$("#mr_email").parent().nextAll("p.w_tips:eq(2)").hide()}}}$("#sess_submit").trigger("click")}});function m(aD,aE,e){var aB=$("#workExperience .list_show .mr_jobe_list");var az=$("#educationalBackground .list_show .mr_jobe_list");var aC=$(".toggle");var aA;if(aD){if(aB.length==0||az.length==0){aA="2";j(aC,e,aA)}else{o(e)}}else{if(az.length==0){aA="2";j(aC,e,aA)}else{$(".openresume_tip").hide();o(e)}}}function o(e){if(e){globals.isOpenResume="3"}else{globals.isOpenResume="0"}}function j(aB,e,aA){$(".openresume_tip").hide();aB.addClass("toggle-off");$(".openresume_tip").hide();globals.isOpenResume=aA;switch(aA){case"2":$(".unopen").show();break;case"3":$(".firstset").show();break}globals.isFirstOpen=e;var az=aB.find("input");az.eq(0).attr("checked","checked")}$("#infoForm").validate({rules:{mr_mobile:{required:true,isMobile:true,maxlength:11},mr_email:{required:true,email:true,maxlength:100}},messages:{mr_mobile:{required:"必填",isMobile:"目前仅支持11位有效中国大陆号码",maxlength:"目前仅支持11位有效中国大陆号码"},mr_email:{required:"必填",email:"请输入正确的邮箱",maxlength:"请输入正确的邮箱"}},errorPlacement:function(e,az){$(az).parent().after(e);$(".c_section span.error").css("margin","5px 0 10px 138px")},submitHandler:function(e){$(e).find(":submit").val("保存中...").attr("disabled",true);$("#sess_submit").one("click",function(){var aE=$('input[name="xl"]',e).val();var aC=$('input[name="gznx"]',e).val();var az=$('input[name="mr_mobile"]',e).val();var aA=$('input[name="mr_email"]',e).val();var aD=$('input[name="szcs"]',e).val();var aB=globals.token;$.ajax({url:ctx+"/resume/basic.json",type:"POST",data:{highestEducation:aE,workYear:aC,phone:az,email:aA,liveCity:aD,type:1,resubmitToken:aB},dataType:"json"}).done(function(aF){globals.token=aF.resubmitToken;if(aF.success){$("#sess_submit").hide().siblings("input").show();$(".w_tips").hide();ak();Z="";ai=true;$(".mr_p_info .xl em").text(aE);var aG=aC;if($.trim(aC)!="应届毕业生"){$(".mr_p_info .gzjy em").text(aC+="工作经验")}else{$(".mr_p_info .gzjy em").text(aC)}$(".mr_p_info .city em").text(aD);$(".mr_p_info .mobile em").text(az);$(".mr_p_info .email em").text(aA).attr("title",aA);$("#infoForm .mr_info_edit").addClass("dn");var aH=$(".mr_p_info .mr_edit_unon");aH.attr("data-xl",aE);aH.attr("data-gzjy",aG);aH.attr("data-city",aD);aH.attr("data-mobile",az);aH.attr("data-email",aA);$(".mr_p_info").show()}else{alert(aF.msg)}$(e).find(":submit").val("保 存").attr("disabled",false)})});if(($("#mr_mobile").val()!=$("#sess_phone").val()&&$("#sess_phone").val().length>0)&&($("#mr_email").val()!=$("#sess_email").val()&&$("#sess_email").val().length>0)){$("#mr_mobile").parent().nextAll("p.w_tips:eq(0)").show();$("#sess_submit").show().siblings("input").hide();return}else{if($("#mr_mobile").val()!=$("#sess_phone").val()&&$("#mr_mobile").val().length>0&&$("#sess_phone").val().length>0){$("#mr_mobile").parent().nextAll("p.w_tips:eq(1)").show();$("#sess_submit").show().siblings("input").hide();return}else{$("#mr_mobile").parent().nextAll("p.w_tips:eq(1)").hide();if($("#mr_email").val()!=$("#sess_email").val()&&$("#mr_email").val().length>0&&$("#sess_email").val().length>0){$("#mr_email").parent().nextAll("p.w_tips:eq(2)").show();$("#sess_submit").show().siblings("input").hide();return}else{$("#mr_email").parent().nextAll("p.w_tips:eq(2)").hide()}}}$("#sess_submit").trigger("click")}});$("#infoForm .mr_info_edit .mr_cancel").bind("click",function(){$(".mr_info_edit").addClass("dn");$("#xl").val($(this).attr("data-xl"));$("#gznx").val($(this).attr("data-gzjy"));$("#mr_mobile").val($(this).attr("data-mobile"));$("#mr_email").val($(this).attr("data-email"));$("#szcs").val($(this).attr("data-city"));$("#sess_submit").hide().siblings("input").show();$(".w_tips").hide();$(".mr_p_info").show();ai=true});$("#olinfoForm .mr_info_edit .mr_cancel").bind("click",function(){$(".mr_info_edit").addClass("dn");var aA=$("#olinfoForm");aA.find("span.error").hide();aA.find("input.error").removeClass("error");$("#mr_year").val($(this).attr("data-birthYear"));$("#mr_month").val($(this).attr("data-birthMonth"));var az=$(this).attr("data-sex");$(".mr_sex span,.mr_sex i").removeClass("active");if(az=="男"||az==""){$(".mr_sex .mr_man").addClass("active");$(".mr_sex .mr_man i").addClass("active")}else{$(".mr_sex .mr_women").addClass("active");$(".mr_sex .mr_women i").addClass("active")}var e=$(".info_t .shenfen em");globals.personIdFlag=e.attr("data-id");$("#shenfen").val(e.text());$("#xl").val($(this).attr("data-xl"));$("#gznx").val($(this).attr("data-gzjy"));$("#mr_mobile").val($(this).attr("data-mobile"));$("#mr_email").val($(this).attr("data-email"));$("#szcs").val($(this).attr("data-city"));$("#sess_submit").hide().siblings("input").show();$(".w_tips").hide();$(".mr_p_info").show();ai=true;Z="";ak()});$(".mr_p_info .mr_edit_unon").bind("click",function(){$(".mr_p_info").hide();$("#xl").val($(this).attr("data-xl"));$("#gznx").val($(this).attr("data-gzjy"));$("#mr_mobile").val($(this).attr("data-mobile"));$("#mr_email").val($(this).attr("data-email"));$("#szcs").val($(this).attr("data-city"));$("#infoForm .mr_info_edit").removeClass("dn");$("#infoForm").find(":submit").val("保存").attr("disabled",false);ai=false});$(".mr_p_info .mr_edit_on").bind("click",function(){if(Z==""){$("#olinfoForm").find(":submit").val("保存").attr("disabled",false);f();Z="olinfoForm";ai=false;$(".mr_p_info").hide();var aD=$(this).attr("data-sex");$(".mr_sex span,.mr_sex i").removeClass("active");if(aD=="男"){$(".mr_sex .mr_man").addClass("active");$(".mr_sex .mr_man i").addClass("active")}else{if(aD=="女"){$(".mr_sex .mr_women").addClass("active");$(".mr_sex .mr_women i").addClass("active")}}var aA=$(".info_t .shenfen em");globals.personIdFlag=aA.attr("data-id");if(!aA.parent().hasClass("dn")){if($.trim(aA.text())=="·"){$("#shenfen").val("")}else{$("#shenfen").val(aA.text()).attr("title",aA.text())}}else{$("#shenfen").val("")}if($.trim($(".ul_shenfen").text())==""){$(".mr_showidentity_div").bind("click",af)}else{$(".mr_showidentity_div").unbind("click",af)}$("#xl").val($(this).attr("data-xl"));$("#gznx").val($(this).attr("data-gzjy"));var e=$("#gznx").val();if($.trim(e)=="应届毕业生"){var az=$(".ul_shenfen li[data-id = '1']");if(az.length!=0){globals.personIdFlag="1"}}else{var aC=$(".ul_shenfen li[data-id = '2']");if(aC.length!=0){globals.personIdFlag="2"}}$("#mr_mobile").val($(this).attr("data-mobile"));$("#mr_email").val($(this).attr("data-email"));$("#szcs").val($(this).attr("data-city"));if($(".mr_sns a").length>0){$(".mr_add_sns").show();$(".sns_empty").hide();var aB="";$(".mr_sns a").each(function(aG){var aE=$(this).data("sns");var aF=$(this).data("site");var aH="sns"+aE;aB+='<div class="form_wrap mr_sns_m">';aB+=' <i class="'+aH+'"></i>';aB+=' <em class="mr_ok"></em>';aB+=' <a href="javascript:;" class="sns_del"></a>';aB+=' <input type="text" id="'+aH+'" name="'+aH+'" data-sns="'+aE+'" class="mr_button" value="'+aF+'"/>';aB+="</div>"});$(".mr_info_edit .sns_area").html(aB)}if($(".sns_area .mr_sns_m").length==0){$(".mr_add_sns").hide();$(".sns_empty").show()}$("#olinfoForm .mr_info_edit").removeClass("dn")}});function af(az){az.stopPropagation();return false}var aq=(function(){var aC=$("#uploadImages");var aE=aC.find("#cropzoom_container");var aA=aC.find("#crop");var az=aC.find("#restore");var e;aA.bind("click",function(){e.send(ctx+"/resume/cutPic.json","POST",{resubmitToken:globals.token},function(aI){e.showImage.attr("src",ctx+"/"+aI.content.uploadPath+"?cc="+Math.random());$.colorbox.close();e.showImage=null;if(null!=aI.resubmitToken&&""!=aI.resubmitToken){globals.token=aI.resubmitToken}updateResumeTime(aI.content.refreshTime);var aH=aI.content.infoCompleteStatus.score;var aF=parseInt($.trim($(".mr_bfb").text()));var aG=amountScore-aF+aH;updateRatioRM(aH,aG);$(".shadow").hide();$(".mr_headfile").hover(function(){$(".shadow").show()},function(){$(".shadow").hide()});e.restore()})});az.bind("click",function(){e.restore();$(".shadow").hide();$(".mr_headfile").hover(function(){$(".shadow").show()},function(){$(".shadow").hide()});$.colorbox.close()});var aB=function(aF,aG){var aI=$(".mr_headimg");var aH=ctx+"/"+aF.uploadPath;$.colorbox({inline:true,href:aC,title:"选择裁剪区域"});myresumeCommon.config.cutImage.image.source=aH;myresumeCommon.config.cutImage.image.width=aF.srcImageW;myresumeCommon.config.cutImage.image.height=aF.srcImageH;myresumeCommon.config.cutImage.selector.w=myresumeCommon.config.userPhotoSelector.width;myresumeCommon.config.cutImage.selector.h=myresumeCommon.config.userPhotoSelector.height;e=aE.cropzoom(myresumeCommon.config.cutImage);e.showImage=null;e.showImage=aI};var aD=function(){};return{upSucc:aB,upFail:aD}})();window.uploadPhoto=aq;$("#colorbox").on("click","#cboxClose",function(){if($(this).siblings("#cboxLoadedContent").children("div").attr("id")=="uploadImages"){$(".shadow").hide();$(".mr_headfile").hover(function(){$(".shadow").show()},function(){$(".shadow").hide()})}});var w=(function(){var aC=$("#uploadLogos");var aE=aC.find("#cropzoom_container");var aA=aC.find("#crop");var az=aC.find("#restore");var e;var aB=function(aF,aG){var aI=$("#"+aG).next(".logo_u");var aH=ctx+"/"+aF.uploadPath;$.colorbox({inline:true,href:aC,title:"选择裁剪区域"});myresumeCommon.config.cutImage.image.source=aH;myresumeCommon.config.cutImage.image.width=aF.srcImageW;myresumeCommon.config.cutImage.image.height=aF.srcImageH;myresumeCommon.config.cutImage.selector.w=myresumeCommon.config.userPhotoSelector.width;myresumeCommon.config.cutImage.selector.h=myresumeCommon.config.userPhotoSelector.height;e=aE.cropzoom(myresumeCommon.config.cutImage);e.showImage=null;e.showImage=aI};var aD=function(){};aA.bind("click",function(){$(".jobExpForm").find(":submit").val("上传中").attr("disabled",true);e.send(ctx+"/workExperience/cutLogo.json","POST",{resubmitToken:globals.token},function(aF){oMoudle.workId="";e.showImage.css({width:120,height:120}).attr("src",ctx+"/"+aF.content+"?cc="+Math.random());e.showImage.prev().prev().removeClass("active").addClass("up");$.colorbox.close();e.showImage=null;if(null!=aF.resubmitToken&&""!=aF.resubmitToken){globals.token=aF.resubmitToken}$(".jobExpForm").find(":submit").val("保存").attr("disabled",false);e.restore()})});az.bind("click",function(){e.restore();$.colorbox.close()});return{upSucc:aB,upFail:aD}})();window.uploadCompanyLogo=w;$(".mr_uploaded").on("click","a.mr_del",function(){if(confirm("你确定要删除该附件吗？删除后你设置的默认投递简历也将失效")){$.ajax({url:ctx+"/nearBy/delNearBy.json",type:"GET"}).done(function(e){if(e.success){$(".mr_uploaded").hide();$(".mr_upload").show()}else{alert(e.msg)}})}});$(".mr_module ul").delegate(".md_flag a","click",function(aA){aA.stopPropagation();$(".mr_module li").removeClass("active");$(this).parent().addClass("active");var az=$(this).parent().data("md");ap(az,0)});$(".mr_module").unbind("click");$(".mr_module").delegate(".hide_md","click",function(){$(this).addClass("dn").addClass("mr_hide");var e=$(this).data("md");$("#"+e).removeClass("dn");if(e=="customBlock"){initTitlePosition()}$(".m_hide").each(function(){var az=$(this).data("md");if(az==e){$(this).removeClass("dn").addClass("md_flag");ar(e,0);ap(e,1);$(".mr_module li").removeClass("active");$(this).addClass("active");var aA=$(this).attr("data-md");if($.trim(aA)=="customBlock"){$("#customBlock .cust_title span").text("自定义标题")}initTitlePosition()}});if($(".mr_module ul .md_flag").length==9){$(".mr_module_add").addClass("dn")}else{$(".mr_module_add").removeClass("dn")}});$(".mr_module_add").mouseover(function(){$(this).addClass("dn");$(".hide_md").removeClass("dn");$(".hide_md").mouseover(function(){$(".mr_module_add").addClass("dn");$(".hide_md").removeClass("dn")})});$(".hide_md").mouseout(function(){$(".mr_module .hide_md").addClass("dn");var e=0;$(".mr_module .m_hide").each(function(az){if($(this).hasClass("dn")){az++}});if($(".md_flag").length==9){$(".mr_module_add").addClass("dn")}else{$(".mr_module_add").removeClass("dn")}});$(".mr_created").on("click",".mr_md_del",function(az){az.stopPropagation()});$(".mr_hide_del").bind("click",function(az){az.stopPropagation();$(".mr_module .mr_md_del").remove();$(this).parent().after($("#del_hide_tip").html());oDelMoudle=$(this)});$(".mr_created").on("click",".mr_md_del .mr_del_cel",function(az){az.stopPropagation();$(this).parents(".mr_md_del").remove()});var ae=true;$(".mr_created").on("click",".mr_md_del .mr_del_btn",function(aG){if(ae){aG.stopPropagation();$(this).text("删除中");ae=false;var aF=$(this);$(this).unbind();var aC="";var aH=oDelMoudle.parent().parent().data("md");var aB=globals.token;var aA=globals.resumeId;var aI="false";var az;var aE;switch(aH){case"expectJob":aC="/expectJobs/delExpectJobs.json";aI=globals.hasExpectJobs;aE=$("#expHideId").val();az={resumeId:aA,type:1,resubmitToken:aB,id:aE};N.clear();break;case"projectExperience":aC="/projectExperience/delAllProject.json";aI=globals.hasProjectExperiences;az={resumeId:aA,type:1,resubmitToken:aB};n.clear();break;case"selfDescription":aC="/resume/intro.json";aI=globals.hasSelf;az={resumeId:aA,type:1,resubmitToken:aB};v.clear();break;case"worksShow":aC="/workShow/delAllWorkShow.json";aI=globals.hasWorkShows;az={resumeId:aA,type:1,resubmitToken:aB};M.clear();break;case"customBlock":aC="/userDefine/delUserDefine.json";aI=globals.hasUserDefines;aE=$("#customId").val();az={resumeId:aA,type:1,resubmitToken:aB,id:aE};var aD=$("#customBlock");aD.find(".cust_title span").text("自定义标题");aD.find(".custom_list").html("");break;case"skillsAssess":aC="/skillEvaluate/delAllSkill.json";aI=globals.hasSkillEvaluates;az={resumeId:aA,type:1,resubmitToken:aB};ac.clear();break;default:return}if(aI){$.ajax({url:ctx+aC,type:"POST",data:az,dataType:"json"}).done(function(e){if(aH=="expectJob"){$("#expHideId").val("")}globals.token=e.resubmitToken;if(e.success){ag(aF,aH,0,e)}else{alert(e.msg)}ae=true})}else{ag(aF,aH,1,0);ae=true}}});function ag(aE,aC,aA,az){aj();oDelMoudle.parent().parent().removeClass("md_flag").addClass("dn");$("#"+aC).addClass("dn");if(aC!="customBlock"){switch(aC){case"expectJob":globals.hasExpectJobs=false;break;case"skillsAssess":globals.hasSkillEvaluates=false;break;case"selfDescription":globals.hasSelf=false;break;case"worksShow":globals.hasWorkShows=false;break}if(aA==0){var aD=parseInt($.trim($(".mr_bfb").text()));var e=amountScore-aD;var aB=parseInt(az.content.infoCompleteStatus.score);$(".mr_top .mr_bfb").text(aB+"%");amountScore=e+aB;ar(aC,1)}else{ar(aC,1)}}else{$("#customTitleName").val("")}$(".hide_md").each(function(aF){var aG=$(this).data("md");if(aG==aC){$(this).addClass("dn").removeClass("mr_hide")}});if($(".md_flag").length==9){$(".mr_module_add").addClass("dn")}else{$(".mr_module_add").removeClass("dn")}aE.parents(".mr_md_del").remove()}function aj(){switch(Z){case"olinfoForm":$(".mr_p_info").show();$("#olinfoForm .mr_info_edit").addClass("dn");break;case"addJobForm":$("#addJobForm .mr_cancel").trigger("click");break;case"upJobForm":$("#currentUpJobForm .mr_cancel").trigger("click");break;case"addEduForm":$("#addEduForm .mr_cancel").trigger("click");break;case"upEduForm":$("#upEduForm .mr_cancel").trigger("click");break;case"addProForm":$("#addProForm .mr_cancel").trigger("click");break;case"upProForm":$("#currentUpProForm .mr_cancel").trigger("click");break;case"addWorksShowUploadForm":$("#addWorksShowUploadForm .mr_cancel").trigger("click");break;case"upWorksShowUploadForm":$("#upWorksShowUploadForm .mr_cancel").trigger("click");break;case"upSelfForm":$("#upSelfForm .mr_cancel").trigger("click");break;case"upExpJobForm":$("#upExpJobForm .mr_cancel").trigger("click");break;case"upCustomForm":$("#upCustomForm .mr_cancel").trigger("click");break;case"updateSkill":$("#skillsAssess .mr_moudle_content .mr_cancel").trigger("click");break;default:return}ak();Z="";ai=false}function ap(aA,az){if(az==1){aj()}var e=$("#"+aA).offset();switch(aA){case"expectJob":if(az==1){$("#expectJob .mr_head_r").trigger("click")}break;case"workExperience":if(az==1){$("#workExperience .mr_head_r").trigger("click")}break;case"projectExperience":if(az==1){$("#projectExperience .mr_head_r").trigger("click")}break;case"educationalBackground":if(az==1){$("#educationalBackground .mr_head_r").trigger("click")}case"selfDescription":if(az==1){$("#selfDescription .mr_head_r").trigger("click")}break;case"worksShow":if(az==1){$("#worksShow .mr_head_r").trigger("click")}break;case"customBlock":if(az==1){$("#customBlock .mr_head_r").trigger("click")}break;case"skillsAssess":if(az==1){$("#skillsAssess .mr_head_r").trigger("click")}break;case"baseinfo":if(az==1){$("#baseinfo .mr_head_r").trigger("click")}break;default:return}$("body,html").animate({scrollTop:e.top},400,function(){$("#"+aA).animate({borderColor:"#e46a4a"},300,function(){$(this).animate({borderColor:"transparent"})})})}$(".mr_bottom_l").bind("click",function(aA){aA.stopPropagation();var az=$(".mr_down_tip");if(az.is(":hidden")){az.removeClass("dn")}else{az.addClass("dn")}});$(".mr_down_tip li").bind("click",function(az){az.stopPropagation();$(".mr_down_tip").addClass("dn")});$(".mr_down_tip li").hover(function(){$(".mr_down_tip li.active").removeClass("active");$(this).addClass("active")},function(){$(".mr_down_tip li.active").removeClass("active");$(this).removeClass("active")});$(".mr_created").delegate(".mr_delete span","click",function(az){$(this).prev(".mr_delete_pop").removeClass("dn")});$(".mr_created").delegate(".mr_del_cancel","click",function(az){if(I==""){$(this).parent().parent().addClass("dn")}});$(".mr_created").delegate(".mr_del_ok","click",function(){I="1";var aB=$(this).parents(".mr_moudle_content");var aA=$(this).parents("form");var az=$(".mr_del_ok",aA).data("id");var e="";switch(Z){case"upJobForm":e="/workExperience/delExp.json";break;case"upEduForm":e="/educationExperience/delEdu.json";break;case"upExpJobForm":$("#upExpJobForm .mr_cancel").trigger("click");break;case"upProForm":e=myresumeCommon.requestTargets.projectExpDel;break;default:return}$(this).text("删除中...").attr("disabled",true);var aC=$(this);$.ajax({url:ctx+e,type:"POST",data:{id:az,resubmitToken:globals.token},dataType:"json"}).done(function(aO){if(aO.success){if(null!=aO.resubmitToken&&""!=aO.resubmitToken){globals.token=aO.resubmitToken}updateResumeTime(aO.content.refreshTime);var aE=aO.content.infoCompleteStatus.score;var aG=parseInt($.trim($(".mr_bfb").text()));var aF=amountScore-aG+aE;amountScore=aF;updateRatioRM(aE,aF);switch(Z){case"upJobForm":var aK=aO.content.isOpenMyResume;var aI=aO.content.firstOpen;q(aK,aI);if(aB.find(".updatejob_wrap .mr_jobe_list").length==1){aB.find(".mr_empty_add").show();var aN=$.trim($(".base_info .j").text());if(($(".shenfen em").attr("data-id")=="2"||$(".shenfen em").attr("data-id")=="0")){$(".mr_infoed .info_t .shenfen").addClass("dn");$(".mr_p_info .mr_edit_on").attr("data-sf","")}var aL=$(".ul_shenfen li[data-id = '2']");if(aL){aL.remove()}var aM=$(".mr_module .flag_work");if($.trim($("#workExperience .mr_title_c").text())!="实习经历"&&aM.is(":hidden")){aM.removeClass("dn")}}a(aO);break;case"upEduForm":var aK=aO.content.isOpenMyResume;var aI=aO.content.firstOpen;q(aK,aI);if(aB.find(".mr_jobe_list").length==1){aB.find(".mr_empty_add").show();var aN=$.trim($(".base_info .j").text());if(($(".shenfen em").attr("data-id")=="1"||$(".shenfen em").attr("data-id")=="0")){$(".mr_infoed .info_t .shenfen").addClass("dn");$(".mr_p_info .mr_edit_on").attr("data-sf","")}var aH=$(".ul_shenfen li[data-id = '1']");if(aH){aH.remove()}var aM=$(".mr_module .flag_edu");if(aM.is(":hidden")){aM.removeClass("dn")}}a(aO);break;case"upExpJobForm":$("#upExpJobForm .mr_cancel").trigger("click");break;case"upProForm":$("#currentUpProForm .mr_cancel").trigger("click");var aD=n.obj.find(".mr_empty_add");var aJ=aO&&aO.content&&aO.content.projectExperiences||[];if(aJ.length){globals.hasProjectExperiences=true;aD.hide()}else{globals.hasProjectExperiences=false;aD.show()}break;default:return}ak();Z="";ai=true;aA.prev().remove();aA.remove()}else{alert(aO.msg)}I="";aC.text("删除").attr("disabled",false)})});function q(aA,e){if(!aA){$(".openresume_tip").hide();$(".unopen").show();$(".toggle").addClass("toggle-off");globals.isOpenResume="2";globals.isFirstOpen=e;var az=$(".toggle").find("input");az.eq(0).attr("checked","checked")}}var am={obj:$("#workExperience"),clearError:function(e){this.obj.find("span.error").hide();this.obj.find("input.error").removeClass("error")},rules:{companyName:{required:true,maxlenStr:40},positionName:{required:true,maxlenStr:30},startTime:{required:true},endTime:{required:true},editorValue:{required:false,ueditorLength:[0,1600]}},messages:{companyName:{required:"必填",maxlenStr:"请输入80字符以内的公司名称"},positionName:{required:"必填",maxlenStr:"请输入60字符以内的职位名称"},startTime:{required:"必填"},endTime:{required:"必填"},editorValue:{ueditorLength:"请输入1600字符以内的工作内容"}},AddCancel:function(){$("#addJobForm").addClass("dn");if(this.obj.find(".mr_jobe_list").length<=1){this.obj.find(".mr_empty_add").show()}ak();this.obj.find(".mr_head_r").removeClass("mr_add_grey").removeClass("mr_up_grey").removeClass("mr_addup_cel").children("em").text("添加");Z="";ai=true},UpCancel:function(){ak();$("#currentUpJobForm").prev().show();$("#currentUpJobForm").hide();$("#currentUpJobForm").attr("id","");Z="";ai=true}};try{var H=new components.CityWrapper({container:$("#olinfoForm .city_s"),onchange:function(az,e){e.find(".error").hide()},beforeShown:function(az,e){$(document).trigger("click");$(".select_color").removeClass("select_color");az.addClass("select_color")},afterHide:function(az,e){az.removeClass("select_color")}});var au=new components.CityWrapper({container:$("#upExpJobForm .city_s"),onchange:function(az,e){e.find(".error").hide()},beforeShown:function(az,e){$(document).trigger("click");$(".select_color").removeClass("select_color");az.addClass("select_color")},afterHide:function(az,e){az.removeClass("select_color")}});var h=new components.CityWrapper({container:$("#infoForm .city_s"),onchange:function(az,e){e.find(".error").hide()},beforeShown:function(az,e){$(document).trigger("click");$(".select_color").removeClass("select_color");az.addClass("select_color")},afterHide:function(az,e){az.removeClass("select_color")}})}catch(F){}try{var U=new components.CalendarWrapper({container:$("#addJobForm").find(".mr_timed_div:first"),onchange:function(az,e){d.setLeftBoundary(az);e.find(".error").hide()},beforeShown:function(az,e){d.hide();$(".select_color").removeClass("select_color");az.addClass("select_color");az.css("zIndex","2");az.siblings("div:last").css("zIndex","1")},afterHide:function(az,e){az.removeClass("select_color");az.css("zIndex","auto");az.siblings("div:last").css("zIndex","auto")}});var d=new components.CalendarWrapper({container:$("#addJobForm").find(".mr_timed_div:last"),onchange:function(az,e){U.setRightBoundary(az);e.find(".error").hide()},beforeShown:function(az,e){U.hide();$(".select_color").removeClass("select_color");az.addClass("select_color")},afterHide:function(az,e){az.removeClass("select_color")},has2Today:true});var ad,D}catch(F){}var c=null;am.obj.delegate(".mr_head_r","click",function(aA){if(!c){c=UE.getEditor("ueditor_addjob");c.addListener("ready",function(){c.setContent("");c.on("contextmenu",function(){return true})})}c.addListener("keyup",function(){this.sync();$("#addJobForm").find("textarea").valid()});am.clearError();W(c);var az=am.obj.find(".mr_empty_add");if($(this).children("em").text()=="添加"){if(Z==""){Z="addJobForm";ai=false;$("#addJobForm").removeClass("dn");f();$(this).removeClass("mr_add_grey").removeClass("mr_up_grey").addClass("mr_addup_cel").children("em").text("取消");if(az.not(":hidden")){az.hide()}}}else{ai=true;$("#addJobForm").addClass("dn");ak();$(this).removeClass("mr_add_grey").removeClass("mr_up_grey").removeClass("mr_addup_cel").children("em").text("添加");Z="";if(am.obj.find(".mr_jobe_list").length<=1){az.show()}}});am.obj.delegate(".mr_empty_add","click",function(az){$(this).hide();$("#workExperience .mr_head_r").trigger("click")});var J=undefined;am.obj.delegate(".mr_edit","click",function(aB){if(Z==""){f();Z="upJobForm";ai=false;$(this).parents(".mr_jobe_list").next().attr("id","currentUpJobForm");$(this).parents(".mr_jobe_list").next().show();$(this).parents(".mr_jobe_list").hide();var aC=$("#currentUpJobForm");aC.find(".companyName").val(aC.prev().find(".l2 h4").text());aC.find(".autoPosition").val(aC.prev().find(".l2 span").text());var aA;if(aC.prev().find(".mr_content_m").css("display")!="block"){aA=""}else{aA=aC.prev().find(".mr_content_m").html()}J="ueditor_"+$(this).data("expid");A=null;A=UE.getEditor(J);if(A.isReady){A.setContent(aA)}A.addListener("ready",function(){A.setContent(aA);A.on("contextmenu",function(){return true})});A.addListener("keyup",function(){this.sync();aC.find("textarea").valid()});$(".mr_del_ok",aC).attr("data-id",$(this).data("expid"));oMoudle.workId=$(this).data("expid");$("img.logo_u",aC).prev().prev().addClass("up");var az=$(this).attr("data-logo");if(az!=""){az=ctx+"/"+az;$("img.logo_u",aC).css({width:120,height:120}).attr("src",az);$("input[name='companyLogoHide']",aC).val(az)}else{az="";$(".mr_upload_logo div",aC).removeClass("up");$("img.logo_u",aC).css({width:0,height:0}).attr("src",az);$("input[name='companyLogoHide']",aC).val("")}b();ad=new components.CalendarWrapper({container:aC.find(".mr_timed_div:first"),onchange:function(aD,e){D.setLeftBoundary(aD);e.find(".error").hide()},beforeShown:function(aD,e){D.hide();$(".select_color").removeClass("select_color");aD.addClass("select_color")},afterHide:function(aD,e){aD.removeClass("select_color")}});D=new components.CalendarWrapper({container:aC.find(".mr_timed_div:last"),onchange:function(aD,e){ad.setRightBoundary(aD);e.find(".error").hide()},beforeShown:function(aD,e){ad.hide();$(".select_color").removeClass("select_color");aD.addClass("select_color")},afterHide:function(aD,e){aD.removeClass("select_color")},has2Today:true});ad.set($(this).attr("data-startime"),true);D.set($(this).attr("data-endtime"),true);handleFrames()}});am.obj.delegate(".mr_upload_logo","mouseover",function(){var e=$(this).find("div");if(!e.hasClass("up")){e.addClass("active")}});am.obj.delegate(".mr_upload_logo","mouseout",function(){var e=$(this).find("div");if(!e.hasClass("up")){e.removeClass("active")}});am.obj.delegate("#currentUpJobForm .mr_cancel","click",function(az){am.UpCancel()});$("#addJobForm .mr_cancel").bind("click",function(az){am.AddCancel()});$(".mr_created").delegate("a.mce_fullscreen","click",function(){var e=$("#mce_fullscreen_container .mceToolbarRow1");var aC=$("#mce_fullscreen_container #mce_fullscreen_toolbargroup");var az='<a href="javascript:;" class="writeBtn">写好了</a>';var aD=$(this).attr("id");var aA=aD.split("_");aD=aA[0];aC.append(az);$(window).resize(function(){$("table#mce_fullscreen_tbl").css("width","100%")});$("#mce_fullscreen_container .writeBtn").bind("click",function(aE){ff.fullscreenEditor.execCommand("mceFullScreen")});e.find("td:nth-child(3)").addClass("borderLNone");var aB=$("#mce_fullscreen_ifr")[0].contentDocument.body;$(aB).css({backgroundColor:"#f9f9f9",color:"#555",fontSize:"16px"});aB.focus()});function W(e){$("#addJobForm").submit(function(){e.sync()}).validate({rules:am.rules,messages:am.messages,errorPlacement:function(az,aA){if(aA.attr("type")=="hidden"){$(aA).parent().css("margin-bottom","20px");az.appendTo($(aA).parent())}else{if(aA.is("textarea")){$(aA).parent().find(".wrap_editor").after(az)}else{az.insertAfter($(aA).parent())}}},submitHandler:function(aA){var az=globals.resumeId;var aB=$("img.logo_u",aA).attr("src");var aI=$('input[name="companyName"]',aA).val();var aH=$('input[name="positionName"]',aA).val();var aC=$('input[name="startTime"]',aA).val();var aE=$('input[name="endTime"]',aA).val();var aG=e.getContent().replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"");var aD=globals.token;var aF=false;if($.trim(aB)!=""){aF=true}$(aA).find(":submit").val("保存中...").attr("disabled",true);$.ajax({url:ctx+"/workExperience/save.json",type:"post",data:{id:az,companyLogo:aB,companyName:aI,positionName:aH,startDate:aC,endDate:aE,workContent:aG,resubmitToken:aD,isUploadLogo:aF},dataType:"json"}).done(function(aS){globals.token=aS.resubmitToken;if(aS.success){var aK=aS.content.isOpenMyResume;var aQ=$(".toggle");var aO=aS.content.firstOpen;globals.isFirstOpen=aO;if(aK){$(".openresume_tip").hide();if(globals.isFirstOpen){globals.isOpenResume="3";$(".firstset").show()}else{if(aQ.hasClass("toggle-off")){globals.isOpenResume="0"}else{globals.isOpenResume="1"}}}a(aS);r();$("img.logo_u",aA).css({width:0,height:0});$("div.up",aA).removeClass("up");updateResumeTime(aS.content.refreshTime);var aL=aS.content.infoCompleteStatus.score;var aN=parseInt($.trim($(".mr_bfb").text()));var aM=amountScore-aN+aL;updateRatioRM(aL,aM);am.obj.find(".mr_head_r").trigger("click");var aP=aS.content.workExperiences;g(aP);var aJ=am.obj.find(".mr_empty_add");if(aJ.not(":hidden")){aJ.hide()}var aR=$(".mr_module .flag_work");if(!aR.is(":hidden")){aR.addClass("dn")}e.setContent("");U.reset();d.reset()}else{$(aA).find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+aS.msg+"</span>")}$(aA).find(":submit").val("保 存").attr("disabled",false)})}})}function r(){var e=$("#addJobForm");$("#companyLogo",e).val("");$("img.logo_u",e).attr("src","");$("#companyName",e).val("");$("#positionName",e).val("");$("#startTime",e).val("");$(".mr_btn",e).val("");$("#endTime",e).val("");$("#jobContent",e).val("")}function b(){$("#currentUpJobForm").submit(function(){A.sync()}).validate({rules:am.rules,messages:am.messages,errorPlacement:function(e,az){if(az.attr("type")=="hidden"){$(az).parent().css("margin-bottom","20px");e.appendTo($(az).parent())}else{if(az.is("textarea")){$(az).parent().find(".wrap_editor").after(e)}else{e.insertAfter($(az).parent())}}},submitHandler:function(az){var aD=globals.token;var e=globals.resumeId;var aE=$("#currentUpJobForm > .mr_expid").val();var aC=$("img.logo_u",az).attr("src");var aJ=$('input[name="companyName"]',az).val();var aI=$('input[name="positionName"]',az).val();var aB=$('input[name="startTime"]',az).val();var aG=$('input[name="endTime"]',az).val();var aA=A.getContent().replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"");var aF=$("input[name='companyLogoHide']",az).val();var aH=false;if(aF!=aC){aH=true}$(az).find(":submit").val("保存中...").attr("disabled",true);$.ajax({url:ctx+"/workExperience/save.json",type:"post",data:{id:e,companyLogo:aC,companyName:aJ,positionName:aI,startDate:aB,endDate:aG,workContent:aA,resubmitToken:aD,expid:aE,isUploadLogo:aH},dataType:"json"}).done(function(aL){globals.token=aL.resubmitToken;if(aL.success){a(aL);updateResumeTime(aL.content.refreshTime);var aN=aL.content.infoCompleteStatus.score;var aK=parseInt($.trim($(".mr_bfb").text()));var aM=amountScore-aK+aN;updateRatioRM(aN,aM);$(".mr_cancel",az).trigger("click");var aO=aL.content.workExperiences;g(aO)}else{$(az).find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+aL.msg+"</span>")}$(az).find(":submit").val("保 存").attr("disabled",false)})}})}function g(aE){var aC=am.obj.find(".list_show");var az=am.obj.find(".list_show .updatejob_wrap .mr_jobe_list");var aD=am.obj.find(".list_show .new_addjob_hide .mr_jobe_list");var aG=am.obj.find(".list_show .new_addjob_hide .jobExpForm");if(aE.length>az.length){var aH=[];for(var aA=0;aA<aE.length;aA++){aH.push(aE[aA].id)}var e=aH[0];for(var aB=0;aB<aH.length;aB++){if(e<aH[aB]){e=aH[aB]}}var aF=aH.indexOf(e);if(aE[aF].companyLogo){$(aD).find("img").attr("src",ctx+"/"+aE[aF].companyLogo)}$(aD).find("h4").text(aE[aF].companyName);$(aD).find("h4").next().text(aE[aF].positionName);$(aD).find(".mr_edit").attr({"data-expid":aE[aF].id,"data-logo":aE[aF].companyLogo,"data-comname":aE[aF].companyName,"data-posname":aE[aF].positionName,"data-startime":aE[aF].startDate,"data-endtime":aE[aF].endDate,"data-content":aE[aF].workContent});$(aD).find(".mr_content_r span:eq(0)").text(aE[aF].startDate);$(aD).find(".mr_content_r span:eq(2)").text(aE[aF].endDate);if(aE[aF].workContent){$(aD).find(".mr_content_m").show();$(aD).find(".mr_content_m").html(aE[aF].workContent)}else{$(aD).find(".mr_content_m").hide()}$(aG).find(".mr_expid").val(aE[aF].id);$(aG).find(".mr_sta_time .mr_btn").val(aE[aF].startDate);$(aG).find(".mr_sta_time .startTime").val(aE[aF].startDate);$(aG).find(".mr_end_time .mr_btn").val(aE[aF].endDate);$(aG).find(".mr_end_time .endTime").val(aE[aF].endDate);if(aE[aF].companyLogo&&aE[aF].companyLogo!=""){$(aG).find('input[name="companyLogoHide"]').val(ctx+"/"+aE[aF].companyLogo)}if(aF>0){$(az[aF-1]).next().after($(".new_addjob_hide").html());$(az[aF-1]).next().next().next().find(".companyName").val(aE[aF].companyName);$(az[aF-1]).next().next().next().find(".autoPosition").val(aE[aF].positionName);$(az[aF-1]).next().next().next().find("script").attr("id","ueditor_"+aE[aF].id);$(az[aF-1]).next().next().next().find(".mr_upload_logo .companyLogo_new_hide").attr("id","upcompanyLogo_"+aE[aF].id)}else{am.obj.find(".list_show .updatejob_wrap").prepend($(".new_addjob_hide").html());$(am.obj.find(".list_show .updatejob_wrap").find(".jobExpForm")[0]).find(".companyName").val(aE[aF].companyName);$(am.obj.find(".list_show .updatejob_wrap").find(".jobExpForm")[0]).find(".autoPosition").val(aE[aF].positionName);$(am.obj.find(".list_show .updatejob_wrap").find(".jobExpForm")[0]).find("script").attr("id","ueditor_"+aE[aF].id);$(am.obj.find(".list_show .updatejob_wrap").find(".jobExpForm")[0]).find(".mr_upload_logo .companyLogo_new_hide").attr("id","upcompanyLogo_"+aE[aF].id)}}else{for(var aB=0;aB<aE.length;aB++){if(aE[aB].companyLogo){$(az[aB]).find("img").attr("src",ctx+"/"+aE[aB].companyLogo);$(az[aB]).next("form").find('input[name="companyLogoHide"]').val(ctx+"/"+aE[aB].companyLogo)}$(az[aB]).find("h4").text(aE[aB].companyName);$(az[aB]).find("h4").next().text(aE[aB].positionName);$(az[aB]).find(".mr_edit").attr({"data-expid":aE[aB].id,"data-logo":aE[aB].companyLogo,"data-comname":aE[aB].companyName,"data-posname":aE[aB].positionName,"data-startime":aE[aB].startDate,"data-endtime":aE[aB].endDate,"data-content":aE[aB].workContent});$(az[aB]).find(".mr_content_r span:eq(0)").text(aE[aB].startDate);$(az[aB]).find(".mr_content_r span:eq(2)").text(aE[aB].endDate);if(aE[aB].workContent){$(az[aB]).find(".mr_content_m").show();$(az[aB]).find(".mr_content_m").html(aE[aB].workContent)}else{$(az[aB]).find(".mr_content_m").hide()}}}}var P={obj:$("#educationalBackground"),rules:{schoolName:{required:true,checkNum:true,maxlenStr:50,truename2:true},positionName:{required:true,checkNum:true,maxlenStr:50,newSpecialChar:true},degree_text:{required:true},graduate_text:{required:true}},messages:{schoolName:{required:"必填",checkNum:"请输入有效的学校名称",maxlenStr:"请输入有效的学校名称",truename2:"请输入有效的学校名称"},positionName:{required:"必填",checkNum:"请输入有效的专业名称",maxlenStr:"请输入有效的专业名称",newSpecialChar:"请输入有效的专业名称"},degree_text:{required:"必填"},graduate_text:{required:"必填"}},errorPlacement:function(e,az){if(az.attr("type")=="hidden"){$(az).parent().css("margin-bottom","20px");e.appendTo($(az).parent())}else{if(az.attr("type")=="button"){e.appendTo($(az).parent())}else{e.insertAfter($(az).parent())}}},clearError:function(e){this.obj.find("span.error").hide();this.obj.find("input.error").removeClass("error")},AddCancel:function(){$("#addEduForm").addClass("dn");if(this.obj.find(".mr_jobe_list").length<=1){this.obj.find(".mr_empty_add").show()}ak();this.obj.find(".mr_head_r").removeClass("mr_add_grey").removeClass("mr_up_grey").removeClass("mr_addup_cel").children("em").text("添加");Z="";ai=true},UpCancel:function(){ak();$("#upEduForm").prev().show();$("#upEduForm").remove();Z="";ai=true}};P.obj.delegate(".mr_head_r","click",function(aA){P.clearError();u();if($(this).children("em").text()=="添加"){var az=P.obj.find(".mr_empty_add");if(Z==""){if(az.not(":hidden")){az.hide()}Z="addEduForm";ai=false;$("#addEduForm").removeClass("dn");f();$(this).removeClass("mr_add_grey").removeClass("mr_up_grey").addClass("mr_addup_cel").children("em").text("取消")}}else{if($("#educationalBackground .mr_jobe_list").length==0){$("#educationalBackground .mr_empty_add").show()}$("#addEduForm").addClass("dn");ak();$(this).removeClass("mr_add_grey").removeClass("mr_up_grey").removeClass("mr_addup_cel").children("em").text("添加");Z=""}});P.obj.delegate(".mr_empty_add","click",function(az){$(this).hide();$("#educationalBackground .mr_head_r").trigger("click")});P.obj.delegate(".mr_edit","click",function(aA){if(Z==""){f();Z="upEduForm";ai=false;var az="";az=$("#edu_update_hide").html();$(this).parents(".mr_jobe_list").hide().after(az);al();l();$(this).parents(".mr_jobe_list").next().attr("id","upEduForm");var aB=$("#upEduForm");$("#eduId",aB).val($(this).data("eduid"));$(".mr_del_ok",aB).attr("data-id",$(this).data("eduid"));oMoudle.eduId=$(this).data("eduid");$('input[name="schoolName"]',aB).val($(this).data("schoolname"));$('input[name="positionName"]',aB).val($(this).data("pro"));$('input[name="degree_text"]',aB).val($(this).data("edu"));$('input[name="degree_val"]',aB).val($(this).data("edu"));$('input[name="graduate_text"]',aB).val($(this).data("date"));$('input[name="graduate"]',aB).val($(this).data("date"));O()}});P.obj.delegate("#upEduForm .mr_cancel","click",function(az){P.UpCancel()});$("#addEduForm .mr_cancel").bind("click",function(az){P.AddCancel()});al();function al(){P.obj.find(".ul_edubg").on("click","li",function(aB){aB.stopPropagation();var aA=$(this).parent().parent();aA.prev().val($(this).text());aA.prev().prev().val($(this).text());aA.hide();$(".select_color").removeClass("select_color");var az=$(this).parents("form").validate().element(aA.prev().prev());if(az){aA.next().hide();$(this).parents(".mr_timed_div").css("margin-bottom","0")}})}l();function l(){P.obj.find(".ul_eduy").on("click","li",function(aB){aB.stopPropagation();var aA=$(this).parent().parent();aA.prev().val($(this).text());aA.prev().prev().val($(this).text());aA.hide();$(".select_color").removeClass("select_color");var az=$(this).parents("form").validate().element(aA.prev().prev());if(az){aA.next().hide();$(this).parents(".mr_timed_div").css("margin-bottom","0")}})}function ao(e){var az=e;$('input[name="schoolName"]',az).val("");$('input[name="positionName"]',az).val("");$('input[name="degree_val"]',az).val("");$('input[name="degree_text"]',az).val("");$('input[name="graduate"]',az).val("");$('input[name="graduate_text"]',az).val("")}function u(){$("#addEduForm").validate({rules:P.rules,messages:P.messages,errorPlacement:function(e,az){P.errorPlacement(e,az)},submitHandler:function(aB){var aE=globals.resumeId;var e=$('input[name="schoolName"]',aB).val();var aC=$('input[name="positionName"]',aB).val();var aD=$('input[name="degree_val"]',aB).val();var aA=$('input[name="graduate"]',aB).val();var az=globals.token;$(aB).find(":submit").val("保存中...").attr("disabled",true);$.ajax({url:ctx+"/educationExperience/save.json",type:"post",data:{id:aE,schoolName:e,professional:aC,education:aD,endYear:aA,resubmitToken:az},dataType:"json"}).done(function(aO){if(aO.success){var aG=aO.content.isOpenMyResume;var aM=$(".toggle");var aK=aO.content.firstOpen;globals.isFirstOpen=aK;if(aG){$(".openresume_tip").hide();if(globals.isFirstOpen){globals.isOpenResume="3";$(".firstset").show()}else{if(aM.hasClass("toggle-off")){globals.isOpenResume="0"}else{globals.isOpenResume="1"}}}a(aO);globals.token=aO.resubmitToken;ao(aB);updateResumeTime(aO.content.refreshTime);var aH=aO.content.infoCompleteStatus.score;var aJ=parseInt($.trim($(".mr_bfb").text()));var aI=amountScore-aJ+aH;updateRatioRM(aH,aI);P.obj.find(".mr_head_r").trigger("click");var aL=aO.content.educationExperiences;S(aL);var aF=P.obj.find(".mr_empty_add");if(aF.not(":hidden")){aF.hide()}var aN=$(".mr_module .flag_edu");if(!aN.is(":hidden")){aN.addClass("dn")}}else{alert(aO.msg)}$(aB).find(":submit").val("保 存").attr("disabled",false)})}})}function O(){$("#upEduForm").validate({rules:P.rules,messages:P.messages,errorPlacement:function(e,az){P.errorPlacement(e,az)},submitHandler:function(aB){var aE=globals.resumeId;var e=$('input[name="schoolName"]',aB).val();var aC=$('input[name="positionName"]',aB).val();var aD=$('input[name="degree_val"]',aB).val();var aA=$('input[name="graduate"]',aB).val();var az=globals.token;$(aB).find(":submit").val("保存中...").attr("disabled",true);$.ajax({url:ctx+"/educationExperience/save.json",type:"POST",data:{id:aE,schoolName:e,professional:aC,education:aD,endYear:aA,resubmitToken:az,eduid:oMoudle.eduId},dataType:"json"}).done(function(aG){if(aG.success){a(aG);globals.token=aG.resubmitToken;ao(aB);updateResumeTime(aG.content.refreshTime);var aI=aG.content.infoCompleteStatus.score;var aF=parseInt($.trim($(".mr_bfb").text()));var aH=amountScore-aF+aI;updateRatioRM(aI,aH);$(".mr_cancel",aB).trigger("click");var aJ=aG.content.educationExperiences;S(aJ)}else{alert(aG.msg)}})}})}function S(aA){var az="";for(var e=0;e<aA.length;e++){az+='<div class="clearfixs mb46 mr_jobe_list">';az+='<div class="mr_content_l">';if(aA[e].schoolBadge!=""){az+='<div class="l1">';az+='<img src="'+ctx+"/"+aA[e].schoolBadge+'" alt="学校Logo"/>';az+="</div>"}az+='<div class="l2">';az+="<h4>"+aA[e].schoolName+"</h4>";az+="<span>"+aA[e].education+" · "+aA[e].professional+"</span>";az+="</div>";az+="</div>";az+='<div class="mr_content_r">';az+='<div class="mr_edit mr_c_r_t" data-eduid = "'+aA[e].id+'" data-schoolname = "'+aA[e].schoolName+'" data-edu = "'+aA[e].education+'" data-pro = "'+aA[e].professional+'" data-date = "'+aA[e].endDate+'">';az+="<i></i><em>编辑</em>";az+="</div>";if(aA[e].whetherGraduate==true){az+="<span>"+aA[e].endDate+"年毕业</span>"}else{az+="<span>"+aA[e].endDate+"年毕业( 预计 )</span>"}az+="</div>";az+="</div>"}P.obj.find(".list_show").html(az)}function a(aD){var aI=$.trim($(".base_info .j").text());var aL=$(".ul_shenfen");var aN=aD.content.resume;var e=aD.content.latestWorkExperience;var aK=aD.content.latestEducationExperience;var az=aN.userIdentity;var aQ=aN.workYear;if(e){var aB=e.positionName+" · "+e.companyName}else{var aB="·"}if(aK){var aP=aK.professional+" · "+aK.schoolName}else{var aP="·"}var aC=$.trim(aP);var aG=$.trim(aB);var aF,aA,aJ;aF=$("span.shenfen");if(aF.length==0){aF=$("<span></span>").addClass("shenfen");$(".info_t").prepend(aF)}aA=$("<i></i>");switch(az){case 0:if($.trim(aQ)=="应届毕业生"){if(aC!="·"){aJ=$("<em data-id='0' title='"+aP+"'>"+aP+"</em>")}else{aJ=$("<em data-id='0' title='"+aB+"'>"+aB+"</em>")}aF.removeClass("dn").empty();aF.append(aA).append(aJ)}else{if(aG!="·"){aJ=$("<em data-id='0' title='"+aB+"'>"+aB+"</em>")}else{aJ=$("<em data-id='0' title='"+aP+"'>"+aP+"</em>")}aF.removeClass("dn").empty();aF.append(aA).append(aJ)}if($.trim(aF.text())=="·"){aF.addClass("dn")}break;case 1:if(aC!="·"){aJ=$("<em data-id='1' title='"+aP+"'>"+aP+"</em>")}else{aJ=$("<em data-id='2' title='"+aB+"'>"+aB+"</em>")}aF.removeClass("dn").empty();aF.append(aA).append(aJ);if($.trim(aF.text())=="·"){aF.addClass("dn")}break;case 2:if(aG!="·"){aJ=$("<em data-id='2' title='"+aB+"'>"+aB+"</em>")}else{aJ=$("<em data-id='1' title='"+aP+"'>"+aP+"</em>")}aF.removeClass("dn").empty();aF.append(aA).append(aJ);if($.trim(aF.text())=="·"){aF.addClass("dn")}break}var aE=aL.find("li[data-id='2']");var aM=aL.find("li[data-id='1']");if(aG!="·"){if(aE.length>0){aE.text(aB)}else{var aO=$("<li></li>").attr({"data-id":"2",title:aB}).text(aB);aL.append(aO)}}else{aE.remove()}if(aC!="·"){if(aM.length>0){aM.text(aP)}else{var aH=$("<li></li>").attr({"data-id":"1",title:aP}).text(aP);aL.append(aH)}}else{aM.remove()}}function B(aK){var aJ=$.trim($(".base_info .j").text());if(aJ=="应届毕业生"){var az=$(".ul_shenfen");var aH=aK.content.resume;var aE=aK.content.latestEducationExperience;var aF=aH.userIdentity;var aD=aH.workYear;var aI=aE.professional+" · "+aE.schoolName;var aC,e,aA;aC=$("span.shenfen");e=$("<i></i>");switch(aF){case"0":aA=$("<em data-id='0' title='"+aI+"'>"+aI+"</em>");aC.removeClass("dn").empty();aC.append(e).append(aA);break;case"1":aA=$("<em data-id='1' title='"+aI+"'>"+aI+"</em>");aC.removeClass("dn").empty();aC.append(e).append(aA);break}var aG=az.find("li[data-id='1']");if(aG){aG.text(aI)}else{var aB=$("</li>").attr({"data-id":"1",title:aI}).text(aI);az.append(aB)}}}var n={obj:$("#projectExperience"),clearError:function(e){this.obj.find("span.error").hide();this.obj.find("input.error").removeClass("error")},AddCancel:function(){var e=$("#addProForm");e.addClass("dn");e.find('input[name="projectName"]').val("");e.find('input[name="thePost"]').val("");e.find('input[name="startTime"]').val("");e.find('input[name="endTime"]').val("");e.find('input[name="pro_link"]').val("");e.find('input[type="button"]').val("");if(this.obj.find(".mr_jobe_list").length<=2){this.obj.find(".mr_empty_add").show();globals.hasProjectExperiences=false}ak();this.obj.find(".mr_head_r").removeClass("mr_add_grey").removeClass("mr_up_grey").removeClass("mr_addup_cel").children("em").text("添加");Z="";ai=true;this.checkState();V.reset();R.reset()},UpCancel:function(){ak();$("#currentUpProForm").prev().show();$("#currentUpProForm").hide();$("#currentUpProForm").attr("id","");Z="";ai=true;this.checkState()},checkState:function(){if(this.obj.find(".mr_jobe_list").length<=2){this.obj.find(".mr_empty_add").show();globals.hasProjectExperiences=false}else{this.obj.find(".mr_empty_add").hide();globals.hasProjectExperiences=true}},clear:function(){var az=$("#addProForm");az.find('input[name="projectName"]').val("");az.find('input[name="thePost"]').val("");az.find('input[name="startTime"]').val("");az.find('input[name="endTime"]').val("");az.find('input[name="pro_link"]').val("");az.find('input[type="button"]').val("");var e=this.obj;e.find(".list_show").html(e.find(".temp_hide").html());e.find(".mr_empty_add").show();this.clearError();this.checkState()}};var V=new components.CalendarWrapper({container:$("#addProForm").find(".mr_timed_div:first"),onchange:function(az,e){R.setLeftBoundary(az);e.find(".error").hide()},beforeShown:function(az,e){R.hide();$(".select_color").removeClass("select_color");az.addClass("select_color")},afterHide:function(az,e){az.removeClass("select_color")}});var R=new components.CalendarWrapper({container:$("#addProForm").find(".mr_timed_div:last"),onchange:function(az,e){V.setRightBoundary(az);e.find(".error").hide()},beforeShown:function(az,e){V.hide();$(".select_color").removeClass("select_color");az.addClass("select_color")},afterHide:function(az,e){az.removeClass("select_color")},has2Today:true});var av,E;var p=null;n.obj.delegate(".mr_head_r","click",function(az){if(p){p.setContent("")}else{p=UE.getEditor("ueditor_addpro");p.addListener("ready",function(){p.setContent("");p.on("contextmenu",function(){return true})});p.addListener("keyup",function(){this.sync();$("#addProForm").find("textarea").valid()})}n.clearError();Y(p);if($(this).children("em").text()=="添加"){if(Z==""){Z="addProForm";ai=false;$("#addProForm").removeClass("dn");f();$(this).removeClass("mr_add_grey").removeClass("mr_up_grey").addClass("mr_addup_cel").children("em").text("取消");n.checkState();n.obj.find(".mr_empty_add").hide()}}else{$("#addProForm").addClass("dn");ak();$(this).removeClass("mr_add_grey").removeClass("mr_up_grey").removeClass("mr_addup_cel").children("em").text("添加");Z="";n.checkState();if(n.obj.find(".mr_jobe_list").length<=1){n.obj.find(".mr_empty_add").show()}}});n.obj.delegate(".mr_empty_add","click",function(az){$(this).hide();$("#projectExperience .mr_head_r").trigger("click")});n.obj.delegate(".mr_edit","click",function(aC){if(Z==""){f();Z="upProForm";ai=false;$(this).parents(".mr_jobe_list").next().attr("id","currentUpProForm");$(this).parents(".mr_jobe_list").next().show();$(this).parents(".mr_jobe_list").hide();var az=$("#currentUpProForm");var aB=$(this).attr("data-remark")?$(this).attr("data-remark"):"";A=null;A=UE.getEditor("ueditor_"+$(this).attr("data-id"));if(A.isReady){A.setContent(aB)}A.addListener("ready",function(){A.setContent(aB);A.on("contextmenu",function(){return true})});A.addListener("keyup",function(){this.sync();az.find("textarea").valid()});var aA=$(this).parents(".mr_jobe_list");at(aA.attr("data-id"));az.find(".mr_del_ok").attr("data-id",aA.data("id"));az.find('input[name="projectName"]').val($.trim(aA.find(".projectTitle").text()));az.find('input[name="thePost"]').val($.trim(aA.find(".l2 p").text()));var aD=$.trim(aA.find(".mr_content_r span").text()).split(" - ");az.find('input[name="startTime"]').val(aD[0]).prev().val(aD[0]);az.find('input[name="endTime"]').val(aD[1]).prev().val(aD[1]);az.find('textarea[name="upproContent"]').val($.trim(aA.find(".mr_content_m").html()));az.find('input[name="pro_link"]').val($.trim(aA.find(".projectTitle").attr("href")));n.checkState();av=new components.CalendarWrapper({container:az.find(".mr_timed_div:first"),onchange:function(aE,e){E.setLeftBoundary(aE);e.find(".error").hide()},beforeShown:function(aE,e){E.hide();$(".select_color").removeClass("select_color");aE.addClass("select_color")},afterHide:function(aE,e){aE.removeClass("select_color")}});E=new components.CalendarWrapper({container:az.find(".mr_timed_div:last"),onchange:function(aE,e){av.setRightBoundary(aE);e.find(".error").hide()},beforeShown:function(aE,e){av.hide();$(".select_color").removeClass("select_color");aE.addClass("select_color")},afterHide:function(aE,e){aE.removeClass("select_color")},has2Today:true});av.set(aD[0],true);E.set(aD[1],true);handleFrames()}});n.obj.delegate("#currentUpProForm .mr_cancel","click",function(az){n.UpCancel()});$("#addProForm .mr_cancel").bind("click",function(az){n.AddCancel()});function Y(e){$("#addProForm").submit(function(){e.sync()}).validate({rules:{projectName:{required:true,maxlenStr:50},thePost:{required:true,maxlenStr:30},startTime:{required:true},endTime:{required:true},editorValue:{required:false,ueditorLength:[10,1600]},pro_link:{maxlenStr:60,checkUrl:true}},messages:{projectName:{required:"必填",maxlenStr:"请输入100字符以内的项目名称"},thePost:{required:"必填",maxlenStr:"哇，你的职责这么厉害，你的公司知道吗？60个字符以内哦"},startTime:{required:"必填"},endTime:{required:"必填"},editorValue:{ueditorLength:"请输入10-1600字符的项目描述"},pro_link:{maxlenStr:"链接太长，目前只支持120字符以内哦",checkUrl:"请输入有效的项目链接"}},errorPlacement:function(az,aA){if(aA.attr("type")=="hidden"){$(aA).parent().css("margin-bottom","25px");az.appendTo($(aA).parent())}else{if(aA.is("textarea")){$(aA).parent().find(".wrap_editor").after(az)}else{az.insertAfter($(aA).parent())}}},submitHandler:function(aE){var aB=$('input[name="projectName"]',aE).val();var aF=$('input[name="thePost"]',aE).val();var aD=$('input[name="startTime"]',aE).val();var aA=$('input[name="endTime"]',aE).val();var az=e.getContent().replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"");var aC=$('input[name="pro_link"]',aE).val();$(aE).find(":submit").val("保存中...").attr("disabled",true);myresumeCommon.utils.addHttpPrefix("http://|https://",aC,function(aG){aC=(aC==""?"":aG)});$.ajax({url:ctx+"/"+myresumeCommon.requestTargets.projectExpSave,type:"POST",data:{id:globals.resumeId,projectid:"",projectName:$.trim(aB),positionName:$.trim(aF),startDate:$.trim(aD),endDate:$.trim(aA),projectRemark:$.trim(az),dutyRemark:"",projectUrl:$.trim(aC)},dataType:"json"}).done(function(aI){if(aI.success){Z="";ai=true;ak();$("#addProForm").addClass("dn");var aL=aI&&aI.content&&aI.content.projectExperiences||[];ax(aL);n.AddCancel();var aH=n.obj.find(".mr_empty_add");if(aL.length){aH.hide()}else{aH.show()}updateResumeTime(aI.content.refreshTime);if(oMoudleScore.projectExpScore!=""){amountScore=amountScore-oMoudleScore.projectExpScore}oMoudleScore.projectExpScore="";var aK=aI.content.infoCompleteStatus.score;var aG=parseInt($.trim($(".mr_bfb").text()));var aJ=amountScore-aG+aK;updateRatioRM(aK,aJ);n.checkState();V.reset();R.reset()}else{$(aE).find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+aI.msg+"</span>")}$(aE).find(":submit").val("保 存").attr("disabled",false)})}})}function at(e){$("#currentUpProForm").submit(function(){A.sync()}).validate({rules:{projectName:{required:true,maxlenStr:50},thePost:{required:true,maxlenStr:30},startTime:{required:true},endTime:{required:true},editorValue:{required:false,ueditorLength:[10,1600]},pro_link:{maxlenStr:60,checkUrl:true}},messages:{projectName:{required:"必填",maxlenStr:"请输入100字符以内的项目名称"},thePost:{required:"必填",maxlenStr:"哇，你的职责这么厉害，你的公司知道吗？60个字符以内哦"},startTime:{required:"必填"},endTime:{required:"必填"},editorValue:{ueditorLength:"请输入10-1600字符的项目描述"},pro_link:{maxlenStr:"链接太长，目前只支持120字符以内哦",checkUrl:"请输入有效的项目链接"}},errorPlacement:function(az,aA){if(aA.attr("type")=="hidden"){$(aA).parent().css("margin-bottom","25px");az.appendTo($(aA).parent())}else{if(aA.is("textarea")){$(aA).parent().find(".wrap_editor").after(az)}else{az.insertAfter($(aA).parent())}}},submitHandler:function(aE){var aB=$('input[name="projectName"]',aE).val();var aF=$('input[name="thePost"]',aE).val();var aD=$('input[name="startTime"]',aE).val();var aA=$('input[name="endTime"]',aE).val();var az=A.getContent().replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"");var aC=$('input[name="pro_link"]',aE).val();$(aE).find(":submit").val("保存中...").attr("disabled",true);myresumeCommon.utils.addHttpPrefix("http://|https://",aC,function(aG){aC=(aC==""?"":aG)});$.ajax({url:ctx+"/"+myresumeCommon.requestTargets.projectExpSave,type:"POST",data:{id:globals.resumeId,projectid:e,projectName:$.trim(aB),positionName:$.trim(aF),startDate:$.trim(aD),endDate:$.trim(aA),projectRemark:$.trim(az),dutyRemark:"",projectUrl:$.trim(aC)},dataType:"json"}).done(function(aI){$(aE).find(":submit").val("保存").attr("disabled",false);if(aI.success){Z="";ai=true;ak();var aL=aI&&aI.content&&aI.content.projectExperiences||[];ax(aL);n.UpCancel();var aH=n.obj.find(".mr_empty_add");if(aL.length){aH.hide()}else{aH.show()}updateResumeTime(aI.content.refreshTime);if(oMoudleScore.projectExpScore!=""){amountScore=amountScore-oMoudleScore.projectExpScore}oMoudleScore.projectExpScore="";var aK=aI.content.infoCompleteStatus.score;var aG=parseInt($.trim($(".mr_bfb").text()));var aJ=amountScore-aG+aK;updateRatioRM(aK,aJ);n.checkState()}else{$(aE).find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+aI.msg+"</span>")}})}})}function ax(aF){var aD=n.obj.find(".list_show");var az=n.obj.find(".list_show .updatepro_wrap .mr_jobe_list");var aE=n.obj.find(".list_show .new_addpro_hide .mr_jobe_list");var aG=n.obj.find(".list_show .new_addpro_hide .proExpForm");if(aF.length>az.length){var e=[];for(var aB=0;aB<aF.length;aB++){e.push(aF[aB].id)}var aA=e[0];for(var aC=0;aC<e.length;aC++){if(aA<e[aC]){aA=e[aC]}}var aH=e.indexOf(aA);$(aE).attr("data-id",aF[aH].id);if(aF[aH].projectUrl&&aF[aH].projectUrl!=""){$(aE).find(".projectTitle").attr("href",aF[aH].projectUrl);$(aE).find(".projectTitle").attr("target","_blank");$(aE).find(".projectTitle").html(aF[aH].projectName+"<i></i>")}else{$(aE).find(".projectTitle").addClass("nourl");$(aE).find(".projectTitle").text(aF[aH].projectName)}$(aE).find(".l2 p").text(aF[aH].positionName);$(aE).find(".mr_edit").attr("data-id",aF[aH].id);$(aE).find(".mr_edit").attr("data-remark",aF[aH].projectRemark);$(aE).find(".mr_content_r span:eq(0)").text(aF[aH].startDate);$(aE).find(".mr_content_r span:eq(2)").text(aF[aH].endDate);if(aF[aH].projectRemark&&aF[aH].projectRemark!=""){$(aE).find(".mr_content_m").html(aF[aH].projectRemark)}else{$(aE).find(".mr_content_m").addClass("dn")}if(aH>0){$(az[aH-1]).next().after(n.obj.find(".list_show .updatepro_wrap").parent().find(".new_addpro_hide").html());$(az[aH-1]).next().next().next().find("script").attr("id","ueditor_"+aF[aH].id)}else{n.obj.find(".list_show .updatepro_wrap").prepend(n.obj.find(".list_show .updatepro_wrap").parent().find(".new_addpro_hide").html());$(n.obj.find(".list_show .updatepro_wrap").find(".proExpForm")[0]).find("script").attr("id","ueditor_"+aF[aH].id)}}else{for(var aC=0;aC<aF.length;aC++){for(var aB=0;aB<az.length;aB++){if($(az[aB]).attr("data-id")==aF[aC].id){if(aF[aC].projectUrl&&aF[aC].projectUrl!=""){$(az[aB]).find(".projectTitle").attr("href",aF[aC].projectUrl);$(az[aB]).find(".projectTitle").attr("target","_blank");$(az[aB]).find(".projectTitle").html(aF[aC].projectName+"<i></i>")}else{$(az[aB]).find(".projectTitle").addClass("nourl");$(az[aB]).find(".projectTitle").text(aF[aC].projectName)}$(az[aB]).find(".l2 p").text(aF[aC].positionName);$(az[aB]).find(".mr_edit").attr("data-id",aF[aC].id);$(az[aB]).find(".mr_edit").attr("data-remark",aF[aC].projectRemark);$(az[aB]).find(".mr_content_r span:eq(0)").text(aF[aC].startDate);$(az[aB]).find(".mr_content_r span:eq(2)").text(aF[aC].endDate);$(az[aB]).find(".mr_content_m").html(aF[aC].projectRemark)}}}}}var v={obj:$("#selfDescription"),clearError:function(e){this.obj.find("span.error").hide();this.obj.find("input.error").removeClass("error")},UpCancel:function(){$("#upSelfForm").addClass("dn");ak();Z="";ai=true;this.obj.find(".mr_head_r").removeClass("mr_up_grey").removeClass("mr_add_grey").removeClass("mr_addup_cel").children("em").text("编辑");this.obj.find(".self_des_list").removeClass("dn");this.checkState()},clear:function(){v.obj.find(".mr_self_r").html("");this.checkState();this.clearError()},checkState:function(){if($.trim($(".mr_self_r").html())==""){v.obj.find(".mr_empty_add").show();v.obj.find(".self_des_list").addClass("dn")}else{v.obj.find(".mr_empty_add").hide();v.obj.find(".self_des_list").removeClass("dn")}}};v.obj.delegate(".mr_head_r","click",function(aA){v.clearError();if($(this).children("em").text()=="编辑"){if(Z==""){A=null;A=UE.getEditor("ueditor_selfDescribe");if(A.isReady){A.setContent(v.obj.find(".mr_self_r").html())}A.addListener("ready",function(){A.setContent(v.obj.find(".mr_self_r").html());A.on("contextmenu",function(){return true})});A.addListener("keyup",function(){this.sync();$("#upSelfForm").find("textarea").valid()});Z="upSelfForm";ai=false;$("#upSelfForm").removeClass("dn");f();v.obj.find(".self_des_list").addClass("dn");$(this).removeClass("mr_add_grey").removeClass("mr_up_grey").addClass("mr_addup_cel").children("em").text("取消");var az=$("#upSelfForm");v.obj.find(".mr_empty_add").hide()}}else{$("#upSelfForm").addClass("dn");ak();$(this).removeClass("mr_up_grey").removeClass("mr_add_grey").removeClass("mr_addup_cel").children("em").text("编辑");Z="";v.obj.find(".self_des_list").removeClass("dn");ai=true;if(A.getContent()==""){v.obj.find(".mr_empty_add").show()}v.checkState()}});$("#upSelfForm .mr_cancel").bind("click",function(az){v.UpCancel()});v.obj.find(".mr_empty_add").bind("click",function(az){v.obj.find(".mr_head_r").trigger("click")});$("#upSelfForm").submit(function(){A.sync()}).validate({rules:{editorValue:{required:true,ueditorLength:[10,1600]}},messages:{editorValue:{required:"必填",ueditorLength:"请输入10-1600字符的自我描述"}},errorPlacement:function(e,az){if(az.attr("type")=="text"||az.attr("type")=="button"){$(az).parent().css("margin-bottom","20px");e.appendTo($(az).parent())}else{if(az.is("textarea")){$(az).parent().find(".wrap_editor").after(e)}else{e.insertAfter($(az).parent())}}},submitHandler:function(e){$(e).find(":submit").val("保存中...").attr("disabled",true);myresumeCommon.utils.requester({url:myresumeCommon.requestTargets.myRemark,data:{resumeId:globals.resumeId,myRemark:A.getContent().replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"")}},function(aC){$(e).find(":submit").val("保 存").attr("disabled",false);if(aC.success){v.clearError();v.UpCancel();v.obj.find(".mr_self_r").html(aC.content.resume.myRemark);updateResumeTime(aC.content.refreshTime);globals.hasSelf=true;if(oMoudleScore.myRemarkScore!=""){amountScore=amountScore-oMoudleScore.myRemarkScore}oMoudleScore.myRemarkScore="";if($.trim(v.obj.find(".mr_self_r").html())!=""){v.obj.find(".mr_empty_add").hide();v.obj.find(".self_des_list").removeClass("dn")}var aB=aC.content.infoCompleteStatus.score;var az=parseInt($.trim($(".mr_bfb").text()));var aA=amountScore-az+aB;updateRatioRM(aB,aA)}else{$(e).find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+aC.msg+"</span>")}})}});var N={obj:$("#expectJob"),clearError:function(e){this.obj.find("span.error").hide();this.obj.find("input.error").removeClass("error")},UpCancel:function(){$("#upExpJobForm").addClass("dn");ak();Z="";ai=true;this.obj.find(".mr_head_r").removeClass("mr_up_grey").removeClass("mr_add_grey").removeClass("mr_addup_cel").children("em").text("编辑");this.obj.find(".expectjob_list").removeClass("dn");this.checkState()},clear:function(){var aB=$("#expectJob .expectjob_list");var aD=aB.find(".mr_job_name").html("");var aC=aB.find(".mr_job_type").html("");var e=aB.find(".mr_job_adr").html("");var aA=aB.find(".mr_job_range").html("");var az=aB.find(".mr_job_des").html("");this.checkState();this.clearError()},checkState:function(){if($.trim($(".expectjob_list").text()).replace(/\s/g,"")==""){N.obj.find(".expectjob_list").addClass("dn");N.obj.find(".mr_empty_add").show()}else{N.obj.find(".mr_empty_add").hide();N.obj.find(".expectjob_list").removeClass("dn");globals.hasExpectJobs=true}},clearCityError:function(){N.obj.find(".mr_job_city").find("span.error").hide()},clearPayError:function(){N.obj.find(".mr_pay_div").find("span.error").hide()},clearPayLayer:function(){N.obj.find(".xl_list:first, .xl_list:last").hide()}};N.obj.delegate(".mr_head_r","click",function(aD){N.clearError();if($(this).children("em").text()=="编辑"){if(Z==""){var aB=$("#expectJob .expectjob_list");A=null;A=UE.getEditor("ueditor_expJobDes");if(A.isReady){if(aB.find(".mr_expjob_content").html()){A.setContent(aB.find(".mr_expjob_content").html())}}A.addListener("ready",function(){if(aB.find(".mr_expjob_content").html()){A.setContent(aB.find(".mr_expjob_content").html())}A.on("contextmenu",function(){return true})});A.addListener("keyup",function(){this.sync();$("#upExpJobForm").find("textarea").valid()});Z="upExpJobForm";ai=false;$("#upExpJobForm").removeClass("dn");f();v.obj.find(".expectjob_list").addClass("dn");$(this).removeClass("mr_add_grey").removeClass("mr_up_grey").addClass("mr_addup_cel").children("em").text("取消");var aE=aB.find(".mr_job_name").text();var aF=aB.find(".mr_job_type").text();var aG=$(this).attr("data-city")||aB.find(".mr_job_adr").text()||$("#mr_mr_head").find(".mr_p_info .base_info em:last").text()||"";var aC=aB.find(".mr_job_range").text();var aH=aB.find(".mr_expjob_content").html();var az=$("#upExpJobForm");$('input[name="expjobName"]',az).val($.trim(aE));var aA=$.trim(aF);if(aA==""){$('input[name="exp_job_type"]',az).val("全职")}else{$('input[name="exp_job_type"]',az).val(aA)}$('input[name="jobCity"]',az).val($.trim(aG));$('input[name="monthpay"]',az).val($.trim(aC));$("#expJobDes").val($.trim(aH));N.checkState();N.obj.find(".mr_empty_add").hide();N.obj.find(".expectjob_list").addClass("dn")}}else{$("#upExpJobForm").addClass("dn");ak();$(this).removeClass("mr_up_grey").removeClass("mr_add_grey").removeClass("mr_addup_cel").children("em").text("编辑");Z="";v.obj.find(".expectjob_list").removeClass("dn");ai=true;N.checkState()}});$("#upExpJobForm .mr_cancel").bind("click",function(az){N.UpCancel()});N.obj.find(".mr_empty_add").bind("click",function(az){N.obj.find(".mr_head_r").trigger("click")});N.obj.find(".ul_exptype").on("click","li",function(az){az.stopPropagation();$(this).parent().parent().prev().val($(this).text());$(this).parent().parent().hide();$(".select_color").removeClass("select_color")});N.obj.find(".ul_pay").on("click","li",function(az){az.stopPropagation();$(this).parent().parent().prev().val($(this).text());$(this).parent().parent().hide();$(".select_color").removeClass("select_color");N.clearPayError()});$("#upExpJobForm").submit(function(){A.sync()}).validate({rules:{expjobName:{required:false,maxlenStr:30,positionspecialchar:true},editorValue:{ueditorLength:[0,400]},monthpay:{required:false},jobCity:{required:false}},messages:{expjobName:{maxlenStr:"请输入有效的期望职位",positionspecialchar:"格式错误"},editorValue:{ueditorLength:$.validator.format("请输入400字符以内的补充说明")}},errorPlacement:function(e,az){if(az.attr("type")=="text"||az.attr("type")=="button"){$(az).parent().css("margin-bottom","20px");e.appendTo($(az).parent())}else{if(az.is("textarea")){$(az).parent().find(".wrap_editor").after(e)}else{e.insertAfter($(az).parent())}}},submitHandler:function(az){$(az).find(":submit").val("保存中...").attr("disabled",true);var aE=$('input[name="expjobName"]',az).val();var aD=$('input[name="exp_job_type"]',az).val();var e=$('input[name="jobCity"]',az).val();var aB=$('input[name="monthpay"]',az).val();var aA=A.getContent().replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"");var aC=$.trim($("#expectJob .mr_job_info").attr("data-id"));$.ajax({url:ctx+myresumeCommon.requestTargets.expectJobSave,type:"POST",data:{id:globals.resumeId,expectId:aC||"",city:e,positionType:aD,positionName:aE,addExplain:aA,salarys:aB,resubmitToken:globals.token},dataType:"json"}).done(function(aG){if(aG.success){if($.trim(e)==""){$("#expectJob .mr_head_r").attr("data-city","")}if(null!=aG.resubmitToken&&""!=aG.resubmitToken){globals.token=aG.resubmitToken}$(az).find(":submit").val("保 存").attr("disabled",false);updateResumeTime(aG.content.refreshTime);if(oMoudleScore.expectJobsScore!=""){amountScore=amountScore-oMoudleScore.expectJobsScore}oMoudleScore.expectJobsScore="";var aI=aG.content.infoCompleteStatus.score;var aF=parseInt($.trim($(".mr_bfb").text()));var aH=amountScore-aF+aI;updateRatioRM(aI,aH);globals.hasExpectJobs=true;var aJ=$(".mr_module .flag_hopework");if(!aJ.is(":hidden")){aJ.addClass("dn")}var aK=$("#expectJob .expectjob_list");if(aG.content.expectJobs){$("#expHideId").val(aG.content.expectJobs.id)}aK.find(".mr_job_name").text(aE);aK.find(".mr_job_name").attr("title",aE);aK.find(".mr_job_type").text(aD);aK.find(".mr_job_adr").text(e);aK.find(".mr_job_adr").attr("title",e);aK.find(".mr_job_range").text(aB);aK.find(".mr_expjob_content").html(aA);if(aG.content.expectJobs){$("#expectJob .mr_job_info").attr("data-id",aG.content.expectJobs.id)}if($.trim(aE)==""){$(".mr_name_li").addClass("dn")}else{$(".mr_name_li").removeClass("dn")}if($.trim(aD)==""){$(".mr_jobtype_li").addClass("dn")}else{$(".mr_jobtype_li").removeClass("dn")}if($.trim(e)==""){$(".mr_city_li").addClass("dn")}else{$(".mr_city_li").removeClass("dn")}if($.trim(aB)==""){$(".mr_jobrange_li").addClass("dn")}else{$(".mr_jobrange_li").removeClass("dn")}if($.trim(aA)==""){$(".mr_job_des").addClass("dn")}else{$(".mr_job_des").removeClass("dn")}N.UpCancel();$(".expectjob_list").removeClass("dn");$("#upExpJobForm").addClass("dn");ak();Z="";ai=true;N.checkState()}else{$(az).find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+aG.msg+"</span>")}$(az).find(":submit").val("保 存").attr("disabled",false)})}});var C={obj:$("#customBlock"),clearError:function(e){this.obj.find("span.error").hide();this.obj.find("input.error").removeClass("error")},UpCancel:function(){initTitlePosition();$("#upCustomForm").addClass("dn");ak();Z="";ai=true;this.obj.find(".mr_head_r").removeClass("mr_up_grey").removeClass("mr_add_grey").removeClass("mr_addup_cel").children("em").text("编辑");this.obj.find(".custom_list").removeClass("dn");var e=$(".mr_content_cus").text();if($.trim(e)==""){$("#customBlock .mr_empty_add").show()}},SetTitle:function(){var e=$("#customTitleName");if(e.val()==""||!e.val()){$("#customBlock .cust_title span").text("自定义标题")}else{$("#customBlock .cust_title span").text(e.val())}}};C.obj.delegate(".mr_empty_add","click",function(az){$(this).addClass("dn");$("#customBlock .mr_head_r").trigger("click")});$("#customCon").bind("full2restore",function(aA,az){$("#customCon").valid()});C.obj.delegate(".mr_head_r","click",function(aD){$("#customBlock .mr_empty_add").hide();C.clearError();C.obj.find(".mr_add_work img").attr("src",$("#userpic").attr("src"));var aC=$("#customBlock .cust_title").text();var aB=$("#customBlock .custom_list").html();var az=$.trim(aC);if(az=="自定义标题"){$("#upCustomForm input[name='titleName']").val("")}else{$("#upCustomForm input[name='titleName']").val(az)}if($(this).children("em").text()=="编辑"){if(Z==""){A=null;A=UE.getEditor("ueditor_customBlock");if(A.isReady){A.setContent(aB)}A.addListener("ready",function(){A.setContent(aB);A.on("contextmenu",function(){return true})});A.addListener("keyup",function(){this.sync();$("#upCustomForm").find("textarea").valid()});Z="upCustomForm";ai=false;$("#upCustomForm").removeClass("dn");f();C.obj.find(".custom_list").addClass("dn");$(this).removeClass("mr_add_grey").removeClass("mr_up_grey").addClass("mr_addup_cel").children("em").text("取消")}}else{C.SetTitle();initTitlePosition();$("#upCustomForm").addClass("dn");ak();$(this).removeClass("mr_up_grey").removeClass("mr_add_grey").removeClass("mr_addup_cel").children("em").text("编辑");Z="";C.obj.find(".custom_list").removeClass("dn");ai=true;var aA=$(".mr_content_cus").text();if($.trim(aA)==""){$("#customBlock .mr_empty_add").show()}}});$("#upCustomForm .mr_cancel").bind("click",function(az){C.SetTitle();C.UpCancel()});$("#upCustomForm").submit(function(){A.sync()}).validate({rules:{titleName:{required:true,rangeLenStr:[0,10]},editorValue:{required:true,ueditorLength:[2,1600]}},messages:{titleName:{required:"必填",rangeLenStr:"请输入20个字符以内的标题"},editorValue:{required:"必填",ueditorLength:"请输入2-1600字符的有效内容"}},errorPlacement:function(e,az){if(az.attr("id")=="customCon"){$(az).parent().after(e)}else{if(az.is("textarea")){$(az).parent().find(".wrap_editor").after(e)}else{e.insertAfter($(az).parent())}}},submitHandler:function(aA){var e=globals.token;var aD=globals.resumeId;var aC=$("#customId").val();var az=$('input[name="titleName"]',aA).val();var aB=A.getContent().replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"");$(aA).find(":submit").val("保存中...").attr("disabled",true);$.ajax({url:ctx+"/userDefine/titleSave.json",type:"post",data:{id:aD,defineId:aC,titleName:az,titleContent:aB,resubmitToken:e},dataType:"json"}).done(function(aE){if(aE.success){globals.hasUserDefines=true;globals.token=aE.resubmitToken;updateResumeTime(aE.content.refreshTime);$(".mr_cancel",aA).trigger("click");$("#customBlock .mr_moudle_content .mr_empty_add").hide();ak();Z="";ai=true;C.obj.find(".mr_head_r").removeClass("mr_up_grey").removeClass("mr_add_grey").removeClass("mr_addup_cel").children("em").text("编辑");var aH=$('input[name="titleName"]',aA).val();var aG=$("#customCon").val();$("#customBlock .cust_title span").text(aH);$("#upCustomForm").addClass("dn");var aI=aE.content.userDefine;var aF="";aF+='<input id="customTitleName" type="hidden" value="'+aI.titleName+'" />';aF+='<input id="customId" type="hidden" value="'+aI.id+'" />';aF+='<div class="custom_list" data-id="'+aI.id+'">'+aI.titleContent+"</div>";$(".mr_content_cus").html(aF);initTitlePosition()}else{$(aA).find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+aE.msg+"</span>")}$(aA).find(":submit").val("保 存").attr("disabled",false)})}});$("#upCustomForm input[name='titleName']").keyup(function(az){});try{myresumeCommon.utils.inputerListener($("#upCustomForm input[name='titleName']"),function(az){var e=az.length;var aA=0;var aD=az;for(var aB=0;aB<e;aB++){if(az.charCodeAt(aB)<27||az.charCodeAt(aB)>126){aA+=2}else{aA++}var aE=$("#titleName");if(aA>20){aD=az.substring(0,aB);aE.val(aD);break}}if(aD==""){$("#customBlock .cust_title span").text("自定义标题")}else{$("#customBlock .cust_title span").text(aD)}var aC=parseInt($("#customBlock .cust_title").width())/2;$("#customBlock .cust_title").css("margin-left",-aC*0.7)})}catch(F){}var M=(function(){var bk={upload:0,online:1};var bo=bk.upload;var bb={edit:"添加",cancel:"取消"};var bd={normal:0,edit:1};var bp=bd.normal;var a6={editcancel:"mr_addup_cel"};var a2={url:"www.example.com",previewText:"<p>这里是你的作品描述</p>"};var a3=$("#worksShow");var aE=a3.find(".mr_head_r");var bj=aE.find("em");var aD=a3.find(".mr_moudle_content");var aB=aD.find(".mr_worksshow_forms");var aK=aD.find("#addWorksShowUploadForm");var aO=aD.find("#addWorksShowOnlineForm");var aR=aD.find(".mr_work_online");var bl=aD.find(".mr_work_upload");var aC=aD.find(".mr_cancel");var aW=aD.find(".mr_worksshow_forms .mr_save");var a5=aD.find(".mr_empty_add");var aV=aO.find("#workOnlineUrl");var aP=aO.find(".mr_self_sitelink");var a9=aO.find(".mr_wo_preview");var aQ=aK.find("#worksshowUp");aQ.click(function(){$(this).blur()});var bf=aK.find("#worksshowUpShow");var e=aK.find("#workUploadTitle");var aH=function(){return aR.find(".mr_wo_show").length+bl.find(".mr_wu_show").length};var aY=function(){aD.find(".mr_worksshow_tab span").bind("click",function(){var bq=$(this);if(bq.hasClass("selected")){return}aB.find("span.error").hide();if(bq.hasClass("mr_wst_uponline")){aK.hide();aO.show();bo=bk.online}else{aK.show();aO.hide();bo=bk.upload}})};var bh=null,bm=null;var a8=function(){if(Z!=""){return}a9.html(a2.previewText);aP.html(a2.url);bj.text(bb.cancel);aE.addClass(a6.editcancel);bf.css({width:"0",height:"0"});a5.hide();if(bh){bh.setContent("")}else{bh=UE.getEditor("ueditor_adduploadImage");bh.addListener("ready",function(){$("#ueditor_adduploadImage").bind("contextmenu",function(){return false});bh.setContent("");bh.on("contextmenu",function(){return true})})}if(bm){bm.setContent("")}else{bm=UE.getEditor("ueditor_addonlineImage");bm.addListener("ready",function(){$("#ueditor_addonlineImage").bind("contextmenu",function(){return false});bm.setContent("");bm.on("contextmenu",function(){return true})})}aZ(aV,aP,true);aU(a9,true);bh.addListener("keyup",function(){this.sync();aK.find("textarea").valid()});aK.submit(function(){bh.sync()}).validate({rules:{workPicHidden:{required:true},workTitle:{required:false,maxlenStr:50},editorValue:{required:false,ueditorLength:[0,1000]}},messages:{workPicHidden:{required:"请选择要上传的图片"},workTitle:{required:"请输入作品标题",maxlenStr:"请输入有效的作品标题（100字符以内）"},editorValue:{required:"请描述你的作品",ueditorLength:"请输入1000字符以内的描述"}},errorPlacement:function(bq,br){if(br.attr("type")=="button"){bq.appendTo($(br).parent())}else{if(br.is("textarea")){$(br).parent().find(".wrap_editor").after(bq)}else{bq.insertAfter($(br).parent())}}}});bm.addListener("keyup",function(){this.sync();aO.find("textarea").valid()});aO.submit(function(){bm.sync()}).validate({rules:{url:{required:true,maxlenStr:500,checkUrl:true},editorValue:{required:true,ueditorLength:[0,200]}},messages:{url:{required:"请输入在线地址",maxlenStr:"请输入1000字符以内的网址",checkUrl:"请输入有效的在线地址"},editorValue:{required:"请描述你的作品",ueditorLength:"请输入200字符以内的描述"}},errorPlacement:function(bq,br){if(br.attr("type")=="button"){bq.appendTo($(br).parent())}else{if(br.is("textarea")){bq.insertAfter(br.parent().find(".wrap_editor"))}else{bq.insertAfter($(br).parent())}}}});aB.find(".up").removeClass("up");aB.show();bp=bd.edit;Z=bo==bk.upload?"addWorksShowUploadForm":"addWorksShowOnlineForm";ai=false;f()};var az=function(){bj.text(bb.edit);aE.removeClass(a6.editcancel);aB.hide();!aH()&&a5.show();bp=bd.normal;Z="";ai=true;ak()};var aJ=function(){aX();bp==bd.normal?a8():az()};var ba=function(){return{id:globals.resumeId,wsid:"",url:"",workName:"",imageUrl:"",workTitle:"",workDescribe:""}};var bn=function(bu){var bw=bu&&bu.content&&bu.content.workShows||[];var bv={online:"",upload:""};$.each(bw,function(bx,by){by.url&&(bv.online+=myresumeCommon.utils.strFormat(myresumeCommon.templates.workShowOnline,{type:"online",id:by.id,href:by.url,desc:by.workName,ahref:~by.url.indexOf("http://")||~by.url.indexOf("https://")?by.url:("http://"+by.url)}));by.imageUrl&&(bv.upload+=myresumeCommon.utils.strFormat(myresumeCommon.templates.workShowUpload,{type:"upload",id:by.id,imgsrc:by.cutImageUrl,imageUrl:by.imageUrl,desc:by.workDescribe,title:by.workTitle,hasTitle:by.workTitle!=""?"":"dn"}))});aR.html(bv.online);bl.html(bv.upload);var bt=$(".mr_wu_con .mr_content_l");bt.each(function(){var bx=$(this);if(bx.hasClass("dn")&&$.trim(bx.parent().next(".mr_wu_con_m").text())!=""){bx.parent().addClass("step_aside");bx.parent().next(".mr_wu_con_m").addClass("step_content")}});bw.length?a5.hide():a5.show();if(bw.length){globals.hasWorkShows=true}else{globals.hasWorkShows=false}updateResumeTime(bu.content.refreshTime);if(oMoudleScore.workShowScore!=""){amountScore=amountScore-oMoudleScore.workShowScore}oMoudleScore.workShowScore="";var bs=bu.content.infoCompleteStatus.score;var bq=parseInt($.trim($(".mr_bfb").text()));var br=amountScore-bq+bs;updateRatioRM(bs,br)};var aF=function(bq){a3.find(":submit").val("保存中...").attr("disabled",true);var bs=ba();if(bo==bk.online){var br=aV.val();myresumeCommon.utils.addHttpPrefix("",br,function(bt){br=(br==""?"":bt)});bs.url=$.trim(br);bs.workName=bm.getContent()}else{if(bo==bk.upload){bs.workTitle=$.trim(e.val());bs.workDescribe=bh.getContent();bs.imageUrl=$.trim(bf.attr("data-origin-src"));bs.cutImageUrl=$.trim(bf.attr("src"))}}myresumeCommon.utils.requester({url:myresumeCommon.requestTargets.workShowSave,data:bs},function(bt){a3.find(":submit").val("保 存").attr("disabled",false);if(bt.success){bn(bt);aE.trigger("click");var bu=$("#worksshowUpShow");bu.attr("src","").attr("data-origin-src","").css({width:0,height:0});bu.prev().prev().removeClass("up");$("#workUploadTitle").val("");$("#workImagesDescContent").val("");if(bq==aO){$("#workOnlineUrl").val("")}bu.parent().find(".work-pic-hidden").val("")}else{a3.find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+bt.msg+"</span>")}})};var aX=function(){aB.find("span.error").hide()};var be=function(){var bq=bo==bk.upload?aK:aO;if(bq.valid()){aF(bq)}return false};var aI={rules:{workPicHidden:{required:true},workTitle:{required:false,maxlenStr:50},workDescribe:{required:false,tinymceLength:[0,500]},url:{required:true,maxlenStr:60,checkUrl:true},workDescribeOnline:{required:false,tinymceLength:[0,100]}},messages:{workPicHidden:{required:"请选择要上传的图片"},workTitle:{required:"请输入作品标题",maxlenStr:"请输入有效的作品标题（100字符以内）"},workDescribe:{required:"请描述你的作品",tinymceLength:"请输入1000字符以内的描述"},url:{required:"请输入在线地址",maxlenStr:"请输入120字符以内的网址",checkUrl:"请输入有效的在线地址"},workDescribeOnline:{required:"请描述你的作品",tinymceLength:"请输入200字符以内的描述"}},errorPlacement:function(bq,br){if(br.attr("type")=="button"){bq.appendTo($(br).parent())}else{bq.insertAfter($(br).parent())}}};var aN=function(bq){return bq.replace(/id="([\w-\d\S]+)"/g,'id="$1-Temp"')};var aZ=function(bq,bt,bs){var br=function(){var bu=$.trim(bq.val());bs&&myresumeCommon.utils.addHttpPrefix("",bu,function(bw){bu=(bu==""?"":bw)});var bv=bt[0].tagName.toLowerCase();if(bv=="a"){if(bu.length==0){}bt.attr("href",bu);bt.html(bu)}else{if(bu.length==0){bu=a2.url}bt.html(bu)}};bq.bind("keyup",br).bind("blur",br)};var aU=function(br,bq){if(bq){bm.on("keyup",function(){br.html($.trim(bm.getContent()))});return}A.on("keyup",function(){br.html($.trim(A.getContent()))})};var aG=function(bw){if(Z!=""){return}Z="addWorksShowOnlineFormUpdate";ai=false;f();var bv=bw.next(".addWorksShowOnlineFormUpdate");bv.find(".workOnlineUrlUpdate").val(bw.find(".mr_self_sitelink").attr("href"));var bs="ueditor_"+bw.attr("data-id");A=null;A=UE.getEditor(bs);if(A.isReady){A.setContent(bw.find(".mr_wo_preview").html())}A.addListener("ready",function(){A.setContent(bw.find(".mr_wo_preview").html());A.on("contextmenu",function(){return true})});bv.show();bw.hide();A.addListener("keyup",function(){this.sync();bv.find("textarea").valid()});var bt=bv.find(".workOnlineUrlUpdate");var bq=bw.attr("data-id");var bu=bv.find(".mr_self_sitelink");var bx=bv.find(".mr_wo_preview");aZ(bt,bu,true);aU(bx);var by=bv.find(".mr_save");var bz=bv.find(".mr_cancel");var br=bv.find(".mr_del_ok");bv.submit(function(){A.sync()}).validate({rules:{url:{required:true,maxlenStr:500,checkUrl:true},editorValue:{required:true,ueditorLength:[0,200]}},messages:{url:{required:"请输入在线地址",maxlenStr:"请输入1000字符以内的网址",checkUrl:"请输入有效的在线地址"},editorValue:{required:"请描述你的作品",ueditorLength:"请输入200字符以内的描述"}},errorPlacement:function(bA,bB){if(bB.attr("type")=="button"){bA.appendTo($(bB).parent())}else{if(bB.is("textarea")){bA.insertAfter(bB.parent().find(".wrap_editor"))}else{bA.insertAfter($(bB).parent())}}},submitHandler:function(){by.val("保存中...").attr("disabled",true);var bA=ba();bA.url=$.trim(bt.val());bA.workName=A.getContent().replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"");bA.wsid=bq;myresumeCommon.utils.requester({url:myresumeCommon.requestTargets.workShowSave,data:bA},function(bB){by.val("保 存").attr("disabled",false);if(bB.success){bn(bB);bz.trigger("click");ak();Z="";ai=true;UE.delEditor(bs)}else{bv.find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+bB.msg+"</span>")}})}});bz.bind("click",function(){bw.show();bv.hide();Z="";ai=true;ak()});br.bind("click",function(){br.text("删除中...").attr("disabled",true);var bA=ba();bA.id=bq;myresumeCommon.utils.requester({url:myresumeCommon.requestTargets.workShowDel,data:bA},function(bE){bn(bE);bz.trigger("click");br.text("删 除").attr("disabled",false);if(oMoudleScore.workShowScore!=""){amountScore=amountScore-oMoudleScore.workShowScore}oMoudleScore.workShowScore="";var bD=bE.content.infoCompleteStatus.score;var bB=parseInt($.trim($(".mr_bfb").text()));var bC=amountScore-bB+bD;amountScore=bC;updateRatioRM(bD,bC);ak();Z="";ai=true});return false})};var aL=function(bw){if(Z!=""){return}Z="addWorksShowUploadFormUpdate";ai=false;f();var bv=bw.next(".addWorksShowUploadFormUpdate");var bB="ueditor_"+bw.attr("data-id");A=null;A=UE.getEditor(bB);if(A.isReady){A.setContent(bw.find(".mr_wu_con_m").html())}A.addListener("ready",function(){A.setContent(bw.find(".mr_wu_con_m").html());A.on("contextmenu",function(){return true})});A.addListener("keyup",function(){this.sync();bv.find("textarea").valid()});bv.show();bw.hide();var bt=bv.find(".workUploadTitleUpdate");var bq=bw.attr("data-id");var bD=$.trim(bw.find(".mr_wu_t img").attr("src"));var bs=$.trim(bw.find(".mr_wu_t img").attr("data-origin-src"));var by=$.trim(bw.find(".mr_work_title").text());by=by.substring(2,by.length-2);var bu=$.trim(bw.find(".mr_wu_con_m").html());var bA=bv.find(".worksshow_img");bA.attr("data-origin-src",bs);var bx=bA.prev().prev();bx.addClass("up");if(bD!=""){bA.css({width:"100%",height:"100%"}).attr("src",bD)}else{logoSrc="";bx.removeClass("up");bA.css({width:0,height:0}).attr("src",bD)}bt.val(by);var bz=bv.find(".mr_save");var bC=bv.find(".mr_cancel");var br=bv.find(".mr_del_ok");bv.submit(function(){A.sync()}).validate({rules:{workPicHidden:{required:true},workTitle:{required:false,maxlenStr:50},editorValue:{required:false,ueditorLength:[0,1000]}},messages:{workPicHidden:{required:"请选择要上传的图片"},workTitle:{required:"请输入作品标题",maxlenStr:"请输入有效的作品标题（100字符以内）"},editorValue:{required:"请描述你的作品",ueditorLength:"请输入1000字符以内的描述"}},errorPlacement:function(bE,bF){if(bF.attr("type")=="button"){bE.appendTo($(bF).parent())}else{if(bF.is("textarea")){$(bF).parent().find(".wrap_editor").after(bE)}else{bE.insertAfter($(bF).parent())}}},submitHandler:function(){bz.val("保存中...").attr("disabled",true);var bE=ba();bE.wsid=bq;bE.workTitle=$.trim(bt.val());bE.workDescribe=A.getContent().replace(/<(?!ol|li|ul|p|\/ol|\/li|\/ul|\/p)[^>]*>/g,"").replace(/<([a-z][a-z0-9]*)[^>]*?(\/?)>/ig,"<$1$2>").replace(/&nbsp;/ig,"");bE.imageUrl=$.trim(bA.attr("data-origin-src"));bE.cutImageUrl=$.trim(bA.attr("src"));myresumeCommon.utils.requester({url:myresumeCommon.requestTargets.workShowSave,data:bE},function(bF){bz.val("保 存").attr("disabled",false);if(bF.success){bn(bF);bC.trigger("click");ak();Z="";ai=true;UE.delEditor(bB)}else{bv.find(".wrap_editor").after('<span for="ueditor_textarea_editorValue" class="error">'+bF.msg+"</span>")}})}});bC.bind("click",function(){bw.show();bv.hide();Z="";ai=true;ak()});br.bind("click",function(){br.text("删除中...").attr("disabled",true);var bE=ba();bE.id=bq;myresumeCommon.utils.requester({url:myresumeCommon.requestTargets.workShowDel,data:bE},function(bF){bn(bF);bC.trigger("click");br.text("删 除").attr("disabled",false);ak();Z="";ai=true});return false})};var aA=function(){var br=$(this);var bq=br.attr("data-type");bq=="online"?aG(br.parents(".mr_wo_show")):aL(br.parents(".mr_wu_show"))};var a7=function(){myresumeCommon.utils.imageUpload("#worksshowUp",ctx+myresumeCommon.requestTargets.workUpload,null,aT)};var a4=function(){aR.html("");bl.html("");aH()?a5.hide():a5.show()};var bg=function(){aE.bind("click",aJ);aC.bind("click",aJ);aW.bind("click",be);aY();a5.click(function(){aE.trigger("click")});aD.delegate(".mr_wo_show .mr_edit_text, .mr_wu_show .mr_edit_text","click",aA);window.setTimeout(function(){},3000)};var a1=$("#cropimageContainer");var a0=a1.find("#cropzoom_container");var bi=a1.find("#cropimageEnsure");var bc=a1.find("#cropimageRestore");var aS;bi.bind("click",function(){$(".add_worksshow_form").find(":submit").val("上传中").attr("disabled",true);aS.send(ctx+myresumeCommon.requestTargets.workCut,"POST",{resubmitToken:globals.token},function(bq){$(".worksshowUpUpdateShow").prev().prev().prev().removeClass("active").addClass("up");$(".worksshowUpUpdateShow").parent().find(".work-pic-hidden").val(bq.content);$(".worksshowUpUpdateShow").attr("src",ctx+"/"+bq.content).css({width:"100%",height:"100%"});aS.showImage.prev().prev().prev().removeClass("active").addClass("up");aS.showImage.parent().find(".work-pic-hidden").val(bq.content);aS.showImage.attr("src",ctx+"/"+bq.content).css({width:"100%",height:"100%"});$.colorbox.close();aS.showImage=null;if(null!=bq.resubmitToken&&""!=bq.resubmitToken){globals.token=bq.resubmitToken}$(".add_worksshow_form").find(":submit").val("保存").attr("disabled",false);aS.restore()})});bc.bind("click",function(){$("#worksShow input[name='workPicHidden']").val("");aS.restore();$.colorbox.close()});var aT=function(bq,br){var bt=$("#"+br+"Show");var bs=ctx+"/"+bq.uploadPath;bt.parent().parent().find(".error").hide();bt.attr("data-origin-src",bs);$.colorbox({inline:true,href:a1,title:"选择裁剪区域"});myresumeCommon.config.cutImage.image.source=bs;myresumeCommon.config.cutImage.image.width=bq.srcImageW;myresumeCommon.config.cutImage.image.height=bq.srcImageH;myresumeCommon.config.cutImage.selector.w=myresumeCommon.config.workShowSelector.width;myresumeCommon.config.cutImage.selector.h=myresumeCommon.config.workShowSelector.height;aS=a0.cropzoom(myresumeCommon.config.cutImage);aS.showImage=bt};var aM=function(bq){};return{init:bg,addUploadSucc:aT,addUploadFail:aM,clear:a4}})();window.worksShowOperator=M;M.init();$("#worksShow").delegate(".mr_worksshow_upimage","mouseover",function(){var e=$(this).find("div");if(!e.hasClass("up")){e.addClass("active")}});$("#worksShow").delegate(".mr_worksshow_upimage","mouseout",function(){var e=$(this).find("div");if(!e.hasClass("up")){e.removeClass("active")}});var ac=(function(){var a3={edit:"编辑",cancel:"取消"};var a4={normal:0,edit:1};var a5={skillplanstart:10,skillplanend:420,skillcirclestart:122,skillcircleend:532,allwidth:410};var bf=a4.normal;var a0={editcancel:"mr_addup_cel"};var aS={inbk:"inline-block"};var aF={defaultText:"了解",hashDefine:{"了解":{min:0,max:84},"熟悉":{min:84,max:168},"掌握":{min:168,max:252},"精通":{min:252,max:336},"专家":{min:336,max:450}}};var a1={skillTitle:"输入技能名称"};var aM=5;var bb=function(){return bf};var aK=function(bh){var bj=aF.defaultText;for(var bi in aF.hashDefine){if((aF.hashDefine[bi].min<bh)&&(bh<=aF.hashDefine[bi].max)){bj=bi;break}}return bj};var aV=$("#skillsAssess");var aD=aV.find(".mr_moudle_content");var aB=aD.find(".mr_skill_con");var aT=aD.find(".me_skill_list");var bc=aV.find(".mr_head_r");var bg=bc.find("em");var aZ=aV.find(".mr_skill_delete");var aO=aV.find(".mr_skill_circle");var aC=aV.find(".mr_skill_level");var aY=aV.find(".mr_empty_add");var aH=aV.find(".mr_skill_add");var aE=aV.find(".mr_skill_add_button");var aG=aV.find(".mr_skill_opera");var aP=aG.find(".mr_save");var a2=aG.find(".mr_cancel");var aL=true;var aI=function(){if(Z!=""){return}bg.text(a3.cancel);bc.addClass(a0.editcancel);be(true);aZ=aT.find(".mr_skill_delete");aO=aT.find(".mr_skill_circle");aC=aT.find(".mr_skill_level");aZ.css("display",aS.inbk);aO.css("display",aS.inbk);aC.hide();aH.show();a8();bf=a4.edit;var bh=$(".mr_skill_name");if($.trim(bh.text())=="输入技能名称"){bh.css("font-style","italic")}Z="updateSkill";ai=false;f();aD.addClass("mr_skilledit_background")};var az=function(){bg.text(a3.edit);bc.removeClass(a0.editcancel);be();aZ=aT.find(".mr_skill_delete");aO=aT.find(".mr_skill_circle");aC=aT.find(".mr_skill_level");aZ.hide();aO.hide();aC.show();aH.hide();bf=a4.normal;Z="";ai=true;ak();aD.removeClass("mr_skilledit_background")};var be=function(bh){if(!aT.children('.mr_skill_con[data-del-flag!="1"]').length){if(bh){aY.hide();aT.html(myresumeCommon.utils.strFormat(myresumeCommon.templates.skillItem,{skillPercent:"10",id:"",skillName:a1.skillTitle,masterLevel:"了解"}));aT.children("div").attr("data-add-flag","1")}else{aY.show();aG.hide()}}};var aJ=function(){aR();bf==a4.normal?aI():az()};var aR=function(){aD.find("div[data-add-flag=1]").remove();aT.children("div[data-del-flag=1]").show().removeAttr("data-del-flag");aX(aD.find("div[data-grade-edit=1]"));aD.find(".mr_skill_con").each(function(){var bh=$(this).find(".mr_skill_name");bh.text(bh.attr("title"))})};var aQ=function(){var bh=[];aT.children("div[data-del-flag=1][data-add-flag!=1]").each(function(bi,bj){bh.push(bj.getAttribute("data-skill-id"))});return bh};var e=function(){var bh=40;var bl=aV.find(".mr_skill_con");var bk=false;var bj=0;var bi;$.each(bl,function(bm){var bo=$(this);if(bo.attr("data-del-flag")==1){return}var bp=$.trim(bo.find(".mr_skill_name").text());if(bp==""||~bp.indexOf(a1.skillTitle)){bi=bm;bk=true;return false}var bn=getStrLen(bp);if(bn>bj){bj=bn;bi=bm}});if(bk){if(undefined!=bi){$(bl[bi]).find(".mr_skill_name").trigger("click")}myresumeCommon.utils.errorTips(aV.find(".error"),"必填");return false}if(bj>bh){if(undefined!=bi){$(bl[bi]).find(".mr_skill_name").trigger("click")}myresumeCommon.utils.errorTips(aV.find(".error"),"请输入20个字符以内的技能名称");return false}return true};var a9=function(){if(!e()){return}var bi=aQ();var bh=a6();aV.find(":submit").val("保存中...").attr("disabled",true);if(bi.length){myresumeCommon.utils.requester({url:myresumeCommon.requestTargets.skillDel,data:{skillId:bi.join(",")}},function(bj){aU(bh)});return}aU(bh)};var aU=function(bh){var bi={skillJson:JSON.stringify(bh),resumeId:globals.resumeId};myresumeCommon.utils.requester({url:myresumeCommon.requestTargets.skillSave,data:bi},function(bj){bd(bj);aJ();aV.find(":submit").val("保 存").attr("disabled",false)})};var bd=function(bk){var bm=bk&&bk.content&&bk.content.skillEvaluates||[];var bl="";$.each(bm,function(bn,bo){bl+=myresumeCommon.utils.strFormat(myresumeCommon.templates.skillItem,bo)});aT.html(bl);bm.length?aY.hide():aY.show();aX(aT.children());if(bm.length){globals.hasSkillEvaluates=true}else{globals.hasSkillEvaluates=false}updateResumeTime(bk.content.refreshTime);if(oMoudleScore.skillScore!=""){amountScore=amountScore-oMoudleScore.skillScore}oMoudleScore.skillScore="";var bj=bk.content.infoCompleteStatus.score;var bh=parseInt($.trim($(".mr_bfb").text()));var bi=amountScore-bh+bj;updateRatioRM(bj,bi)};var a6=function(){var bi=aT.find(".mr_skill_con");var bh=aA(bi);return bh};var a8=function(){aT.children('.mr_skill_con[data-del-flag!="1"]').length>=aM?aE.hide():aE.show()};var aN=function(bh){bh.attr("data-add-flag","1");bh.removeAttr("data-del-flag");bh.find(".mr_skill_plan em").width(a5.skillplanstart);bh.find(".mr_skill_circle").css("left",a5.skillcirclestart).find("em").text(aF.defaultText);bh.removeAttr("data-grade").removeAttr("data-grade-edit").removeAttr("data-skill-id");bh.find(".mr_skill_name").attr("title","").css("font-style","italic");bh.show();a8()};var aX=function(bh){bh=bh||aB;bh.each(function(bj,bk){var bi=a5.allwidth*(bk.getAttribute("data-grade")/100);var bl=$(bk);var bm=aK(bi);bl.find(".mr_skill_plan em").width(a5.skillplanstart+bi);bl.find(".mr_skill_circle").css("left",a5.skillcirclestart+bi+"px").find("em").text(bm);bl.find(".mr_skill_level").text(bm)})};var aA=function(bi){var bh=[];bi=bi||aB;bi.each(function(bk,bn){var bo=$(bn);if(~($.trim(bo.find(".mr_skill_name").text()).indexOf(a1.skillTitle))||bo.attr("data-del-flag")){return}var bj={};var bl=bo.find(".mr_skill_plan em").width()-a5.skillplanstart;var bm=parseInt((bl/a5.allwidth)*100);bj.id=bo.attr("data-skill-id")||"";bj.skillName=$.trim(bo.find(".mr_skill_name").text());bj.masterLevel=$.trim(bo.find(".mr_skill_circle").text());bj.skillPercent=(+bm)<0?0:bm;bh.push(bj)});return bh};var a7=function(bh){$(this).parent(".mr_skill_con").attr("data-del-flag",1).hide();a8();bh.stopPropagation()};var aW=function(){aT.html("");aY.show()};var ba=function(){aX();bc.bind("click",aJ);a2.bind("click",aJ);aY.bind("click",aJ);aP.bind("click",a9);aV.delegate(".mr_skill_delete","click",a7)};return{init:ba,clear:aW,initWidths:a5,rangeDefine:aF,onAddSkill:aN,defaultsText:a1,getState:bb,toggleOpenOnclick:aJ}})();ac.init();function f(){var e=$(".mr_empty_add");e.not("hidden").addClass("addgrey");e.bind("click",x);$(".mr_head_r").each(function(aA){$(this).css("cursor","default");var az=$(this).children("em").text();if(az=="添加"){$(this).addClass("mr_add_grey")}else{if(az=="编辑"){$(this).addClass("mr_up_grey")}}});$(".mr_c_r_t").each(function(aA){$(this).css("cursor","default");var az=$(this).children("em").text();if(az=="添加"){$(this).addClass("mr_add_grey")}else{if(az=="编辑"){$(this).addClass("mr_up_grey")}}})}function x(){return false}function ak(){var e=$(".mr_empty_add");e.not("hidden").removeClass("addgrey");e.unbind("click",x);$(".mr_head_r").each(function(aA){$(this).css("cursor","pointer");var az=$(this).children("em");if($(this).hasClass("mr_add_grey")){az.text("添加");$(this).removeClass("mr_add_grey")}else{if($(this).hasClass("mr_up_grey")){az.text("编辑");$(this).removeClass("mr_up_grey")}}});$(".mr_c_r_t").each(function(aA){$(this).css("cursor","pointer");var az=$(this).children("em");if($(this).hasClass("mr_add_grey")){az.text("添加");$(this).removeClass("mr_add_grey")}else{if($(this).hasClass("mr_up_grey")){az.text("编辑");$(this).removeClass("mr_up_grey")}}});ai=true;Z=""}$(".mr_created").delegate(".mr_click_flag","click",function(az){az.stopPropagation();$(".xl_list").hide();$(".select_color").removeClass("select_color");$(this).addClass("select_color");if(H){H.hide()}if(h){h.hide()}if(au){au.hide()}if(V){V.hide()}if(R){R.hide()}if(av){av.hide()}if(E){E.hide()}if(U){U.hide()}if(d){d.hide()}if(ad){ad.hide()}if(D){D.hide()}if(V){V.hide()}if(R){R.hide()}});$("#skillsAssess").delegate(".mr_skill_circle","mousedown",function(){var e=$(this);var aB=e.siblings(".mr_skill_plan").find("em");var aA=e.parent(".mr_skill_con");var az=e.siblings(".mr_skill_plan");e.parent().attr("data-grade-edit","1");$(document).on("mousemove",function(aD){var aE=aD||event;var aC=aE.clientX-aA.offset().left-122-e.width()/2;if(aC<0){aC=0}else{if(aC>az.width()-e.width()/2){aC=az.width()-e.width()/2}}e.css({left:122+aC+"px"});aB.width(aC+e.width()/2);if(aB.width()<=84){e.find("em").text("了解")}else{if(aB.width()>84&&aB.width()<=168){e.find("em").text("熟悉")}else{if(aB.width()>168&&aB.width()<=252){e.find("em").text("掌握")}else{if(aB.width()>252&&aB.width()<=336){e.find("em").text("精通")}else{if(aB.width()>336){e.find("em").text("专家")}}}}}});$(document).on("mouseup",function(){$(this).off("mousemove");$(this).off("mouseup")});return false});$("#skillsAssess").delegate(".mr_skill_name","click",function(e){if(!ac.getState()){return}$text=$(this).text();var az=$('<input type="text" name="skillname" />');$(this).empty();az.appendTo($(this));az.val($text);az.css({width:"90px",height:"22px","font-size":"14px",border:"none",outline:"none",margin:"0px",padding:"0 5px",border:"1px solid #00b88d","line-height":"22px"});az.on("click",function(aA){aA.stopPropagation()});az.on("focus",function(){var aA=$.trim(az.val());if(aA==""||aA==ac.defaultsText.skillTitle){az.css("color","silver")}else{az.css("color","#000")}az.select()});az.on("blur",function(){var aB=$.trim(az.val())||ac.defaultsText.skillTitle;var aA=az.closest(".mr_skill_name");aA.text(aB);if(aB==ac.defaultsText.skillTitle){aA.css("font-style","italic")}else{aA.css("font-style","normal")}az.remove()});az.on("keyup",function(aA){var aB=$.trim(az.val());az.css("color","#000")});az.focus();e.stopPropagation()});var ah=navigator.appName;var Q=navigator.appVersion;var t=Q.split(";");var X;if(t.length>1){X=t[1].replace(/[ ]/g,"")}if(ah=="Microsoft Internet Explorer"&&X=="MSIE7.0"){}function L(e){if(e.nodeType==1){e.setAttribute("unselectable","on")}var az=e.firstChild;while(az){L(az);az=az.nextSibling}}$(".mr_skill_add_button span").on("click",function(aA){var az=$(".mr_skill_con");var e=$(".mr_skill_con").eq(az.length-1);var aB=e.clone(true);aB.find(".mr_skill_name").text(ac.defaultsText.skillTitle);e.after(aB);ac.onAddSkill(aB);aA.stopPropagation()});function ar(aB,aA){var e=parseInt($.trim($(".mr_bfb").text()));var az=0;switch(aB){case"expectJob":az=parseInt(oMdScore.expectJobsScore);oMoudleScore.expectJobsScore=az;break;case"projectExperience":az=parseInt(oMdScore.projectExpScore);oMoudleScore.projectExpScore=az;break;case"worksShow":az=parseInt(oMdScore.workShowScore);oMoudleScore.workShowScore=az;break;case"skillsAssess":az=parseInt(oMdScore.skillScore);oMoudleScore.skillScore=az;break;case"selfDescription":az=parseInt(oMdScore.myRemarkScore);oMoudleScore.myRemarkScore=az;break;default:return}if(aA==0){amountScore=amountScore+az}else{amountScore=amountScore-az}if(amountScore>=100){amountScore=100}if(amountScore<e){amountScore=e}updateRatioRM(e,amountScore)}$(".mr_set_default").bind("click",function(aB){aB.stopPropagation();var aC=$(this);var aA=aC.find(".set_default_wrap");var az=aC.find(".xl_list");if(aA.hasClass("active")){aA.removeClass("active");az.hide()}else{aA.addClass("active");az.show()}});$(".ul_resume_type li").bind("click",function(aA){aA.stopPropagation();var aB=$(this);var az=aB.parent().parent();$.ajax({url:ctx+"/mycenter/resume/setDefaultResume.json",type:"POST",data:{type:aB.attr("data-type")}}).done(function(e){if(e.success){az.hide();$("#default_resume").val(aB.text());$(".set_default_wrap").removeClass("active")}else{alert(e.msg)}})})});function validateChange(c){var b=$(c);var a=b.parents("form").validate().element(b);if(a){b.parent().css("margin-bottom","0")}}function img_check(o,action_url,id){var _obj=$(o);var obj=$("#"+id);var oNext=obj.next();var oPrev=obj.prev();this.AllowExt=".jpg,.gif,.jpeg,.png,.pjpeg";this.FileExt=obj.val().substr(obj.val().lastIndexOf(".")).toLowerCase();if(this.AllowExt!=0&&this.AllowExt.indexOf(this.FileExt)==-1){errorTips("请上传jpg、gif、png格式头像，大小不超过2M")}else{$("#"+id+"_error").text("").hide();$.ajaxFileUpload({url:action_url,secureuri:false,fileElementId:id,data:{companyLogo:obj.val(),workId:oMoudle.workId},dataType:"text",success:function(rs){oMoudle.workId="";var data=eval("("+rs+")");if(data.success){var imgSrc=ctx+"/"+data.content;oPrev.removeClass("active").addClass("up");oNext.css({width:120,height:120}).attr("src",imgSrc);$("#selfDescription").find(".mr_headimg").attr("src",imgSrc)}else{errorTips("上传失败，请重新上传","上传头像")}},error:function(data){errorTips("上传失败，请重新上传","上传头像")}})}}var uploadFlag=1;function file_check(obj,action_url,id){if(uploadFlag==2){return false}uploadFlag=2;$("#loadingImg").css("visibility","visible");var obj=$("#"+id);var userId=$("#userid").val();this.AllowExt=".doc,.docx,.pdf,.ppt,.pptx,.txt,.wps";this.FileExt=obj.val().substr(obj.val().lastIndexOf(".")).toLowerCase();if(obj.val()==""){$("#loadingImg").css("visibility","hidden");return false}else{if(this.AllowExt!=0&&this.AllowExt.indexOf(this.FileExt)==-1){errorTips("只支持word、pdf、ppt、txt、wps格式文件，请重新上传");$("#resumeUpload").val("");$("#loadingImg").css("visibility","hidden");uploadFlag=1}else{$.ajaxFileUpload({type:"POST",url:action_url,secureuri:false,fileElementId:id,data:{userId:userId},dataType:"text",success:function(jsonStr){uploadFlag=1;var json=eval("("+jsonStr+")");$("#loadingImg").css("visibility","hidden");if(json.success){$.ajax({url:ctx+"/mycenter/resume/setDefaultResume.json",type:"POST",data:{type:"0"}}).done(function(result){if(result.success){$("#default_resume").val("默认投递：附件简历")}else{alert(result.msg)}});$(".mr_upload").hide();$(".mr_uploaded .mr_up_main a").text(json.content.nearbyName).attr("title","下载"+json.content.nearbyName);$(".mr_uploaded .mr_up_main p").text(json.content.time);var isShowDefault=$("#isShowDefault");if(isShowDefault.val()=="0"){$(".mr_uploaded .mr_set_default").hide()}else{$(".mr_uploaded .mr_set_default").show()}$(".mr_uploaded").show();$.colorbox({inline:true,href:$("div#uploadFileSuccess"),title:"上传附件简历"})}else{if(json.code==-1){$.colorbox({inline:true,href:$("div#fileResumeUpload"),title:"附件简历上传失败"})}else{if(json.code==-2){$.colorbox({inline:true,href:$("div#fileResumeUploadSize"),title:"附件简历上传失败"})}else{uploadFlag=1;errorTips("简历上传失败，请重新上传");$("#loadingImg").css("visibility","hidden")}}}},error:function(err){errorTips("简历上传失败，请重新上传");$("#loadingImg").css("visibility","hidden");uploadFlag=1;$(".btn_s").click(function(){window.location.reload()});$("#colorbox").on("click","#cboxClose",function(){if($(this).siblings("#cboxLoadedContent").children("div").attr("id")=="uploadFile"){window.location.reload()}})}})}}}function getStrLen(d){var a=0;var b;var e;for(var b=0;b<d.length;b++){e=d.charCodeAt(b);if(isDbcCase(e)){a=a+1}else{a=a+2}}return a}function isDbcCase(a){if(a>=32&&a<=127){return true}else{if(a>=65377&&a<=65439){return true}}return false}function popQR(){$.ajax({url:ctx+"/qr/qrcode.jpg",type:"GET"}).done(function(a){if(a&&a.success){$(".dropdown_menu img").attr("src",a.content)}})}function updateRatioRM(b,c){var d=b/100*250;if(c>=100){c==100}var a=c/100*250;$(".mr_solid").animate({width:d});$(".mr_dashed").animate({width:a});$(".mr_top .mr_bfb").text(b+"%")}function updateResumeTime(a){$(".upResumeTime").text(a)}function initTitlePosition(){var a=parseInt($("#customBlock .cust_title").width())/2;$("#customBlock .cust_title").css("margin-left",-parseInt(a*0.65))}window.setTimeout(function(){handleFrames()},7000);var openFlag=true;var toggleHandler=function(a){var a=a;var b=$(a).find("input");b.click(function(){if(openFlag){openFlag=false;if(globals.isOpenResume!="3"&&globals.isOpenResume!="2"){if(b.eq(1).is(":checked")){switchResumeStatus(0,a,b)}else{$.colorbox({inline:true,href:$("div#closeplus"),title:"提示"});openFlag=true}}}});$(a).hover(function(){$(".openresume_tip").toggleClass("dn")},function(){$(".openresume_tip").toggleClass("dn")});$("#openResumeStatus .btn").click(function(){switchResumeStatus(0,a,b)});$("#closeplus a").click(function(c){switchResumeStatus(1,a,b)})};function switchResumeStatus(c,a,b){$.colorbox.close();$.ajax({url:ctx+"/mycenter/openMyResume.json",type:"POST",async:false,data:{openStatus:c},dataType:"json"}).done(function(e){clearTimeout(g);var d=$(".openresume_tip");if(e.state==1){d.hide();var f=$(".succ-fail");if(e.content.data.openStatus==1){b.eq(0).attr("checked","checked");$(a).removeClass("toggle-off");f.find("p").text("已开启PLUS");globals.isOpenResume=1;f.show()}else{b.eq(1).attr("checked","checked");$(a).addClass("toggle-off");f.find("p").text("已关闭PLUS");globals.isOpenResume=0;f.show()}var g=setTimeout(function(){f.stop().hide();openFlag=true},3000)}else{if(e.state==405){$(".open_resume_notice").show();return false}else{alert(e.message)}}})}$(document).ready(function(){var a=$(".openresume_tip");if(globals.isOpenResume=="3"){a.hide();$(".firstset").show()}$(".toggle").each(function(c,b){toggleHandler(b)});$(".openresume_tip i").bind("click",function(b){b.stopPropagation;$(this).parent().hide()});$(".toggle").mouseover(function(){switch(globals.isOpenResume){case"0":$(".firstset").show();break;case"2":$(".unopen").show();break;case"3":$(".firstset").show();$(".unopen").hide();break}})});$(".firstset a").on("click",function(){$.ajax({url:ctx+"/mycenter/openMyResume.json",type:"POST",data:{openStatus:0},dataType:"json"}).done(function(){window.location.href="http://www.lagou.com/user/resumePrivacy.html"})});
